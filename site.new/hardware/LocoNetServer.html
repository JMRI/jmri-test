<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: LocoNetServer.html,v 1.2 2005-02-09 22:47:57 kiwi64ajs Exp $ -->
<html lang="en">
<head>
 <TITLE>
      JMRI Hardware Guide: Connecting Multiple Computers to LocoNet via LocoNet Server
 </TITLE>
    <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
    <META content="Bob Jacobsen, LBL" name=Author>
    <META name="keywords" content="Digitrax Chief DCS Command Station LocoNet Server LocoBuffer java model railroad JMRI install windows">

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
<div id="container">
  <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->

  <hr class="hide">

  <div class="nomenu" id="mBody">
    <div id="mainContent">
      <h1> 
      JMRI Hardware Guide: Connecting Multiple Computers to LocoNet via LocoNet Server
      </h1>

JMRI currently supports two subtally different ways that allow you to connect multiple
computers over the standard TCP/IP networking protocol, to your LocoNet-equipped layout
using a single LocoBuffer,

One method uses the inbuilt LocoNet Client/Server capability of JMRI and the other 
allows multiple JMRI nodes to connect as Clients to a single 
<a href="http://loconetovertcp.sourceforge.net/Interface/index.html" >LocoNetOverTCP LbServer</a>, 
which is External to JMRI.<BR><BR>
 
The difference between these two methods is that JMRI LocoNet Client/Server uses the native Java
Remote Method Invocation (RMI) protocol, whereas the LocoNetOverTCP uses a separate non-Java 
server process, LbServer, that communicates using plain ASCII String messages over TCP/IP sockets,
allowing non-Java nodes to also share the one LocoBufer.<BR><BR>

For most people who simply want to have several computers share a single LocoBuffer connection,
the JMRI LocoNet Client/Server is probably the best option as it is easy to configure.
For others wanting to provide remote access the layout over Internet, the LocoNetOverTCP LbServer 
option may be more suitable as firewall rule changes to allow external access will be simpler. 

<h2>Setup for JMRI LocoNet Client/Server</h2>
One computer running JMRI acts as the Server, which is directly connected to the 
LocoNet, the other computers running JMRI connect to the Server computer as Clients.  
<UL>
<LI>Configure the LocoNet connection just like for any other use.
Select the protocol that corresponds to your hardware (e.g. LocoBuffer-II, etc),
the communication port, and other options.  It's best to make sure this is
working well before proceeding.
<LI>You can then manually start the server by selecting "Start LocoNet Server"
from the LocoNet menu.  This will allow other computers to connect to the layout
until you stop the program; the next time you start it, you'll have to do this again.
<LI>You can also have the server start automatically every time you start the
program by
<UL>
<LI>Open the preferences from the Edit menu
<LI>Check the box to "Show Advanced Preferences"
<LI>Under "Do Action At Startup", click "Add Action"
<LI>A list of possibilities will be shown.  Find and select "Start LocoNet Server".
<LI>Save the preferences.
</UL>
</UL>

<P>
The program in the Client computer can then be configured to 
connect to the layout via the LocoNet Server by:
<UL>
<LI>Make sure the Server computer is running the LocoNet server
<LI>Open the program on the Client computer
<LI>Open the preferences from the Edit menu
<LI>For layout connection, select "LocoNet Server"
<LI>In the "Server hostname" box that appears, type the Internet name
or address of the computer that's running the LocoNet Server.
An internet address is something like 127.0.1.12; a name is something
like jmri.sf.net
<li>Save the preferences and restart the program.
</UL>

<h2>Setup for JMRI LocoNetOverTCP</h2>
One computer runs the LbServer program that connects to the LocoBuffer 
and acts as a Server to all the JMRI Client computers. 
Configure the JMRI Client computers to connect to the LbServer as follows:
<UL>
<LI>Make sure the LbServer is configured and running. See LbServer documentations for details.
<LI>Open the JMRI program on the Client
<LI>Open the preferences from the Edit menu
<LI>For layout connection, select "LocoNetOverTCP LbServer"
<LI>In the "Server hostname" box that appears, type the Internet name
or address of the computer that's running the LbServer.
An internet address is something like 127.0.1.12; a name is something
like jmri.sf.net
<li>In the "TCP Port Number" box enter the port number that LbServer is using, which by default is 1234. 
<li>Save the preferences and restart the program.
</UL>

<h2>Notes:</h2>
<UL>
<LI>It's strongly recommended that you connect the master computer
to the LocoNet with a LocoBuffer or LocoBuffer-II.  Although a MS-100
will basically work for this application, correction of the resulting occasional LocoNet
errors may cause noticable delays in updating the remote computers.
<LI>
If the computers are all close to the LocoNet, e.g. acting as local control
panels, you don't really need LocoNet Server to do this.  You can instead
connect each of the computers to the LocoNet via their own LocoBuffer or LocoBuffer-II
(or MS-100, though this is not recommended) and have them individually take part
in the LocoNet communications.  This doesn't cause any additional communications load.
It does cost a little more for the extra adapters, and doesn't permit you to
put a computer remote from the layout.
<LI>The computer running LbServer can also run JMRI software, in this
case the Client and Server just happen to be on the same node. 
<LI>Some firewall software will detect LbServer's use of port 1234 as a trojan and will want to block access to the port. 
To get around this you will either have to enable access in your firewall software or change the port to
another number like 9999 say. The new port number will also need to be passed into LbServer as a command line option.
</UL>

      <hr class="hide">

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 2004-2005 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

   </div><!-- closes #mainContent-->
  </div> <!-- closes #mBody-->
</div> <!-- closes #container -->
</body>
</html>

