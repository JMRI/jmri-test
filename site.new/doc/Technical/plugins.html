
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: plugins.html,v 1.6 2004-11-12 02:56:40 jacobsen Exp $ -->
<html lang="en">
<head>
    <TITLE>
 	JMRI: Plug-in mechanisms
    </TITLE>
    <META content="Bob Jacobsen" name=Author>
    <meta name="keywords" content="JMRI technical code plugins extension plug-in">

    <!-- The combination of "Define" and {Header,Style, Logo and Footer} comments -->
    <!-- are an arbitrary design pattern used by the update.pl script to -->
    <!-- easily replace the common header/footer code for all the web pages -->

    <!-- delete the following 2 Defines if you want to use the default JMRI logo -->
    <!-- or change them to reflect your alternative logo -->

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>


    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->

<!-- Sidebar -->
<!-- This is the common sidebar definition for Technical (developer) pages -->
    <hr class="hide">

    <div id="mBody">

	<div id="side"> <!-- Block of text on left side of page -->
	    <div style="text-align: center">Info on JMRI:</div>
	    <dl>

		<dt>Development tools</dt>
		<dd>
			<ul>
			<LI><a href="getcode.html">Getting the code via CVS</a>
			<LI><a href="CVSFAQ.html">CVS FAQs</a>
			<LI><a href="Ant.html">Building with Ant</a>
			<LI><a href="JBuilder.html">Building with JBuilder</a>
			<LI><a href="Eclipse.html">Building with Eclipse</a>
			<LI><a href="XCode.html">Building with XCode</a>
			</ul>
		</dd>

		<dt>Code Structure</dt>
		<dd>
			<ul>
			<LI><a href="IntroStructure.html">Introduction</a>
			<LI><a href="AppStructure.html">Application Structure</a>
			<LI><a href=""></a>
			<LI><a href="../../JavaDoc/doc">JavaDocs</a><ul>
				<LI><a href="../../JavaDoc/doc/index-all.html">Name Index</a>
				<LI><A HREF="../../JavaDoc/doc/index.html">Packages</A>
				<LI><A HREF="../../JavaDoc/doc/allclasses-frame.html">Class heirarchy</A>
				</UL>
			<LI><a href="Threads.html">Threads</a>
			<LI><a href="XmlPersistance.html">Xml Persistance</a>
			</ul>
		</dd>

		<dt>Techniques and Standards</dt>
		<dd>
			<ul>
			<LI><a href="RP.html">Recommended Practices</a>
			<LI><a href="I8N.html">Internationalization</a>
			<LI><a href="Logging.html">Logging &amp; Error Handling</a>
			<LI><a href="Java118.html">Working with Java 1.1.8</a>
			<LI><a href="JUnit.html">Unit testing with JUnit</a>
			</ul>
		</dd>

		<dt>How To</dt>
		<dd>
			<ul>
			<LI><a href="NewType.html">Add a New Type</a>
			<LI><a href="plugins.html">Extend with Plugins</a>
			</ul>
		</dd>

	    </dl>
	</div>
<!-- /Sidebar -->


	<div id="mainContent">


<h1>JMRI: Plug-in mechanisms</h1>

The original goal of the JMRI project was to produce a library upon which people
could use to build their own applications.  Although some people do that, more
use the existing applications such as DecoderPro, PanelPro, LocoTools and
JmriDemo.  We want to make this more flexible by providing a way to extend
those programs without having to rebuild them from scratch.  This note describes
mechanisms for that which will be included in JMRI version 1.4.0

<OL>

<LI>CLASSPATH
<P>
DecoderPro et al are run via a java command which sets the CLASSPATH and
various options.  How that's actually done varies with the platform:  csh
scripts on Unix, bat files on Windows, application bundles on MacOS X, etc.
<P>
To make it easy to add plug-ins, these will include the files "jmriplugins.jar"
and "lib/jmriplugins.jar" in their CLASSPATH.  
<P>
If you use that name for the jar file including your code, it will automatically
be found. You can also put your classes in the "classes" directory of the
startup directory, which is searched first.
<P>
If some other jar file is necessary, you'll have to edit the startup as needed.


<LI>Replacement of existing classes
<P>
Note that you can directly replace any of the files in the jmri.jar distribution
with your own versions by putting them in a jar file that's searched first.  
For example, including a modified version of a .properties file in the 
jmriplugins.jar file would allow you to include customized versions of menu 
strings.  This can also be done with a .class file, for example changing 
the order of menu items by replacing the DecoderPro class.


<LI>Plugin classes
<P>
Replacing a class can cause extra work in the long term, as the replaced
class may be modified as JMRI evolves.  So we also provide a hook on which
to hang new code.  After initialization is complete, the programs will
attempt to invoke a static member of the form:
<PRE>

  package jmri;
  public class JmriPlugin {
     public static void start(javax.swing.JFrame mainFrame, javax.swing.JMenuBar menuBar) {}
  }

</PRE>
This method
can modify the menubar by inserting, modifying or removing menus or menu
items, add buttons to the main panel, etc.  
<p>
As people use this capability, we'll probably want to refactor some existing
classes to make them easier to extend. For example, a monolithic formatting
class like llnmon should be broken up into smaller pieces to make it easier
to add new formats.

</OL>

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 1997 - 2004 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

	  </div><!-- closes #mainContent-->
	</div> <!-- closes #mBody-->
</body>
</html>
