<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: index.html,v 1.4 2008-02-10 17:10:47 jacobsen Exp $ -->
<html lang="en">
<head>
  <TITLE>
 	JMRI: Block Tracking
  </TITLE>
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">

  <META content="Bob Jacobsen" name=Author>

  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <meta name="keywords"
        content="java model railroad JMRI block tracking">

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
  <div id="container">
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/help/en/html/hardware/index.shtml"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->



	  <hr class="hide">
	  <div id="mBody">
	  <div id="side"> <!-- Block of text on left side of page -->
	    <div style="text-align: center">JMRI is...</div>
	    <dl>

		<dt><h3><a href="../index.html">General Tools</a></h3></dt>
		<dd>JMRI provides powerful tools for working with your
		layout.
		    <UL>
		    <LI><dfn><a href="../throttle/ThrottleMain.html">Throttles</a></dfn>
		    <LI><dfn><a href="ConsistTool.html">Consisting</a></dfn>
		    <LI><dfn><a href="../../../tools/Routes.html">Routes</a></dfn>
		    <LI><dfn><a href="../../../tools/fastclock">Fast Clocks</a></dfn>
		    <LI><dfn><a href="../../apps/Speedometer/index.html">Speedometer</a></dfn>
		    <LI><dfn><a href="../../doc/scripts/index.html">Scripting</a></dfn>
		    </UL>
		</dd>

		<dt><h3><a href="../../apps/LocoTools">LocoNet Tools</a></h3></dt>
		<dd> A set of Digitrax LocoNet specific tools
		    <UL>
		    <LI><dfn>LocoNet monitor</dfn>
		    <LI><dfn>Slot monitor</dfn>
		    <LI><dfn>Packet source</dfn>
		    <LI><dfn>PM4 programmer</dfn>
		    <LI><dfn>BDL16 programmer</dfn>
		    <LI><dfn>LocoIO programmer</dfn>
		    </UL>
		</dd>

		<dt><h3><a href="../apps/Automation">Layout Automation</a></h3></dt>
		<dd>JMRI can be used to automate parts 
		of your layout, from simply controlling a crossing gate
		to running trains in the background.
		    <UL>
		    <LI><dfn><a href="../apps/Signalling">Signaling</a></dfn>
		    <LI><dfn><a href="../../tools/Routes.html">Routes</a></dfn>
		    <LI><dfn><a href="../../tools/fastclock">Fast Clocks</a></dfn>
		    <LI><dfn><a href="../doc/scripts/index.html">Scripting</a></dfn>
		    </UL>
		</dd>

	    </dl>

<a href="/donations.shtml">
 <img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" ALIGN="RIGHT" alt="Support This Project" />
</a> 

	</div> <!-- closes #side -->



    <hr class="hide">

      <div id="mainContent">
      <!-- Page Body -->
    <H2>
    JMRI: Block Tracking
    </H2>

    <h3>
    Background Information
    </h3>

    Model railroad control systems generally can't tell you which
    train occupies a particular piece of track at any given time.
    <P>
    This is unfortunate, because there are lots of reasons you might
    want to know.  For example, you might want to command any train
    that reaches a particular red signal to stop.  But you can't do that
    unless you know <i>which</i> train it is that is reaching the signal.
    <P>
    Starting with test version 1.7.5, JMRI provides experimental
    tools for tracking trains as them move around on the layout.

    <h3>
    Basic Concepts
    </h3>

    Imagine a simple loop of track that's been wired with occupancy 
    sensors on individual segments of track, which we'll call "blocks".
    Imagine the train is in block A, and will shortly move to 
    block B, then C.
    <P>
    At first the sensor for block A is showing active.  As the train moves into
    block B, the sensor for B will go active.  When the train has completely left
    A, it's sensor will go inactive.  Etc.
    <P>
    Although a particular block only knows whether it's active or 
    not (occupied or not), by also looking at the occupancy of the
    adjacent blocks it can tell more.  In the example above, if the code 
    knew that train 321 was in block A, when block B goes active, the program
    can infer that 321 is now also in block B.
    <P>
    This doesn't always work, unfortunately.  Imagine the case above, where there
    is both a train in A and also a train in C.  When B goes from inactive to
    active (unoccupied to occupied), which train moved in?  The one from
    A, or the one from C?
    <P>
    Some of this ambiguity can be removed by careful arrangement of the detection
    blocks, by accepting limitations on how trains can run (or how
    short blocks have to be), and by using more intelligent logic that 
    thinks about the direction and priority of trains.  But it's clear that
    even straight track poses some problems.
    
    <P>
    Turnouts add an additional layer of complexity.  
    Imagine a train
    is siting in the block next to the normal (closed) route, and another
    is siting in the reversed (thrown) route. 
    When the occupancy sensor for the turnout goes active, which train
    has entered the turnout track?  That depends on which way the
    turnout is set, so the program needs to be able to 
    consider that information too.
    
    <h3>
    Tools
    </h3>
    
    JMRI provides a "Block" class to handle the tracking. 
    
    <P>
    Note that this was first available in JMRI 1.7.5, and not
    all features are completely present.  For example, you cannot
    store block objects in a configuration file; they must be manually
    created in your scripts.  This limitations will be removed with time.
    
    <P>
    
    
    
<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 2006 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

      </div><!-- closes #mainContent-->
    </div> <!-- closes #mBody-->
  </div> <!-- closes #container -->
</body>
</html>

