<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: Routes.html,v 1.4 2005-08-03 01:14:28 jacobsen Exp $ -->
<html lang="en">
<head>
  <TITLE>
 	JMRI: Route Documentation
  </TITLE>
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">

  <META content="Bob Jacobsen" name=Author>

  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <meta name="keywords"
        content="hardware layout java model railroad JMRI CMRI decoderpro panelpro tools loconet lenz nce easydcc dcc nmra">

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
  <div id="container">
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->



	  <hr class="hide">
	  <div id="mBody">
	  <div id="side"> <!-- Block of text on left side of page -->
	    <div style="text-align: center">JMRI is...</div>
	    <dl>

		<dt><h3><a href="index.html">General Tools</a></h3></dt>
		<dd>JMRI provides powerful tools for working with your
		layout.
		    <UL>
		    <LI><dfn><a href="throttle/ThrottleMain.html">Throttles</a></dfn>
		    <LI><dfn><a href="Routes.html">Routes</a></dfn>
		    <LI><dfn><a href="../apps/Speedometer/index.html">Speedometer</a></dfn>
		    <LI><dfn><a href="../doc/scripts/index.html">Scripting</a></dfn>
		    </UL>
		</dd>

		<dt><h3><a href="../apps/LocoTools">LocoNet Tools</a></h3></dt>
		<dd> A set of Digitrax LocoNet specific tools
		    <UL>
		    <LI><dfn>LocoNet monitor</dfn>
		    <LI><dfn>Slot monitor</dfn>
		    <LI><dfn>Packet source</dfn>
		    <LI><dfn>PM4 programmer</dfn>
		    <LI><dfn>BDL16 programmer</dfn>
		    <LI><dfn>LocoIO programmer</dfn>
		    </UL>
		</dd>

		<dt><h3><a href="../apps/Automation">Layout Automation</a></h3></dt>
		<dd>JMRI can be used to automate parts 
		of your layout, from simply controlling a crossing gate
		to running trains in the background.
		    <UL>
		    <LI><dfn><a href="../apps/Signalling">Signaling</a></dfn>
		    <LI><dfn><a href="Routes.html">Routes</a></dfn>
		    <LI><dfn><a href="../doc/scripts/index.html">Scripting</a></dfn>
		    </UL>
		</dd>

	    </dl>

<a href="http://sourceforge.net/donate/index.php?group_id=26788"><img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" ALIGN="RIGHT" alt="Support This Project" /> </a> 

	</div> <!-- closes #side -->



    <hr class="hide">

      <div id="mainContent">
      <!-- Page Body -->
        <H2>
		JMRI: Route Documentation
        </H2>

<h3>What are Routes?</h3>

Routes are collections of Turnouts whose states may be set all at once.  For example, a Route may be set up to clear all Turnouts on a mainline with one computer or fascia panel button.  Routes may also be set up to control the setting of ladders of Turnouts in staging areas or yards.  Another use is to set layout Turnouts to default positions when beginning an operating session.  JMRI Routes are similar to the routes implemented in the Digitrax Chief system, except the JMRI Routes can mix Turnouts controlled by different hardware systems.

<h3>How to setup for adding or editing Routes:</h3>

First make sure the Turnout Table contains all Turnouts involved in the Routes to be defined.  Then select Tools>Route Table, and select (click on) the Add... button at the bottom of the table to bring up the Add/Edit Route window.

<h3>To add a new Route:</h3>

<ol>
	<li>Enter a System Name, such as 'IR100'--any short name can be used provided it is 
	different from the System Name of other Routes.
	<P>
	By convention, these usually start with "IR" for Internal Route. 
	</li>
	<li>Enter a User Name, any string of characters that is different from 
	the User Name of other Routes will be accepted, but it's wise to use a string 
	that describes the intended use of the Route.
	<P>
	Note that before JMRI version 1.5.6, there was a bug that prevented you from
	having more than one blank User Name.  In more recent versions, you can have 
	as many Routes with blank User Names as you'd like; these have to be referenced via
	their System Names, of course.
	</li>
	<li>Select Turnouts to be included in the new Route in the list of all 
	defined Turnouts, by clicking on the checkbox in the Include column. 
	For each included Turnout, use the combo box in the Set State column 
	to select whether that Turnout is to be ‘Set Closed’, ‘Set Thrown’ or 
	‘Toggle’d when the Route is 'Set'. Don't worry if everything isn't perfect. 
	It's easy to edit this information later. Note that the Add/Edit Route 
	window allows you to display 'All' Turnouts or 'Included' Turnouts. 
	This is only for your convenience in checking that all desired Turnouts 
	have been included; it does not affect entered information.</li>
	<li>If you want the setting of the Route to be controlled by one or more 
	input Sensors, enter their names and select what kind of logic they'll
	obey.  This is described in more detail
	<A HREF="#sensorlogic">below</a>.
	
	<li>Also optional, if you want to enable setting of the Route from a physical 
	throttle that JMRI monitors, enter a Turnout System Name and select the 
	state, closed or thrown, that will trigger the setting of the Route.  This Turnout 
	can be a real physical Turnout or a 'phantom' Turnout (a Turnout number with no 
	corresponding physical Turnout).  A phantom Turnout is most often used, but there are 
	situations where a real Turnout may be advantageous.</li>
	<li>Select the Add Route button at the bottom of the window.  If everything is fine, 
	a message stating "New Route added ... " will be displayed in the notes box near
	the bottom of the window.  If there is trouble with anything, a message will be 
	displayed in the notes box.</li>
</ol>

<h3>To edit an existing Route:</h3>

<ol>
	<li>Enter the System Name of the Route to be edited.  This must be the same as the System Name shown in the Route Table.</li>
	<li>Select the Edit Route button to display current information for the selected Route. The Add Route and Edit Route buttons will change to Update Route and Cancel.  Note that the System Name of the selected Route may not be changed.</li>
	<li>After making changes to the Route information, select Update Route to  change the selected Route.  If everything is fine, a message stating "Route updated ... " will be displayed in the notes box near the bottom of the window.  If there is any trouble, a message will be displayed in the notes box.</li>
	<li>Select Cancel to exit Edit mode without changing the selected Route.  If the Add/Edit Route window is dismissed (closed) while in Edit mode, Cancel is automatically selected, and no changes are made to the selected Route.</li>
</ol>


<h3>To set (trigger) a Route:</h3>

Routes may be 'set' by clicking the Set button in the State column of the Route Table.  A Route may also be set by fascia panel buttons if Sensors for these buttons are defined in the Route information.  If a control Turnout is defined in the Route information, throwing or closing that Turnout from your physical throttle will also trigger the Route.

<h3>To save Routes to disk:</h3>

Routes are saved in your layout configuration file, along with Turnouts, Sensors, Signal Heads, Lights, etc.  To store this information on disk, use Store Configuration... in the File menu at the top of the Route Table (or other tables from the Tools menu), or select Store Panel... in the Panel menu.

<A ID="sensorlogic">
<H3>Controlling Routes from Sensors</H3></a>

The operation of a route can be controlled by up to three
sensors.  These can be connected to occupancy detectors or switches on the
layout, or even just used to operate the route from a control
panel on the computer.
<P>
By default, when any one of 
the defined Sensors goes to the Active state, the route will be set.  This 
could be used to e.g. set a route when a block became occupied, or 
when a button was pushed.
<P>
More powerful logic can also do things like "define 
routes to have the position of a turnout follow the position of a 
panel switch".  For this, each of the three Sensors has a "mode" 
associated with it, which can be:
<DL>
<DT>"On Active"</DT><DD>The older method, the route sets when the sensor goes 
active, e.g. "Throw turnout 12 when sensor 12 goes active"</DD>

<DT>"On Inactive"</DT><DD>The route sets when the sensor goes inactive.   For 
example, using the route above, plus a second route "Close turnout 12 
when sensor 12 goes inactive" will have turnout 12 follow a panel 
switch connected to sensor 12 as it is flipped back and forth.</DD>

<DT>"Veto Active"</DT><DD>If this sensor is active, other sensors set to "On 
Active" or "On Inactive" will be ignored.  This is used e.g. to 
prevent throwing a turnout under a train when the block shows 
occupied.</DD>

<DT>"Veto Inactive"</DT><DD>Like veto active, but the other polarity logic.</DD>

</DL>
Note that there is an implied "and/or" here.  All of the 'veto' 
signals must be in their non-veto state _and_ at least one of the "on 
active/inactive" sensors must see the appropriate change for the 
route to be set.

    

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 1997 - 2004 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

      </div><!-- closes #mainContent-->
    </div> <!-- closes #mBody-->
  </div> <!-- closes #container -->
</body>
</html>

