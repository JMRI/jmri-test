<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: index.html,v 1.7 2004-11-12 02:56:38 jacobsen Exp $ -->
<html lang="en">
<head>
    <TITLE>
 	JMRI: LocoNet Tools
    </TITLE>
    <META content="Bob Jacobsen" name=Author>
    <meta name="keywords" content="Digitrax LocoNet Tools JMRI decoderpro dcc nmra">

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->

    <hr class="hide">

    <div class="nomenu" id="mBody">
	<div id="mainContent">

	    <!-- ------------- -->
	    <!-- Page Contents --> <!-- Required -->
	    <!-- ------------- -->

	    <H1>LocoNet&trade; Tools</H1>
		<p class=subtitle>
		   LocoNet is a trademark of <a href="http://www.digitrax.com">Digitrax, Inc.</a>
		</p>

		<p>The JMRI project contains a number of LocoNet tools.  This
		page introduces them, describes how to use them, and points you
		to installation and other information.</p>
		<dl>
		    <dt><a HREF="#locomon"><dfn>LocoNet monitor</dfn></a></dt>
		    <dd>
			Display and log the traffic on the LocoNet, in either
			hex or human readable form.
		    </dd>

		    <dt><a HREF="#slotmon"><dfn>Slot monitor</dfn></a> </dt>
		    <dd> Watch the contents of the command station's slots as
		    they're changed.</dd>

		    <dt><a HREF="#sendpkt"><dfn>Packet source</dfn></a> </dt>
		    <dd> A tool to let you type and send packets to the LocoNet</dd>

		    <dt><a HREF="#pm4"><dfn>BDL16, BDL162 and PM4 programmers</dfn></a> </dt>
		    <dd> A tool to let help you configure BDL16, BDL162 and PM4 boards.</dd>

		    <dt><a HREF="#locoio"><dfn>LocoIO programmer</dfn></a> </dt>
		    <dd> A tool to let help you configure a LocoIO board.</dd>
		</dl>

		<p>
		These tools also present in the JMRI demo program, and to some
		extent in DecoderPro. And, of course, you can build them into a
		program of your own!  The LocoNet Tools program is simply a
		convenient platform for finding and accessing these features.</p>

		<p>The libraries also contain utilities for controlling your
		layout (operating turnouts and signals, responding to inputs
		and block occupancy, etc), for programming decoders, and
		others.  These are not LocoNet specific, so are described
		elsewhere on this web site.</p>

		<div class=list>
		    <dl>
		    <dt class=im100w>
			<a href="images/LocoMonFrame.gif">
			    <img src="images/LocoMonFrame.gif"
			         width=100 height=50
			         alt="LocoNet Monitor"></a>
		    </dt>
		    <dd class=first>
		    <H2><a name="locomon">LocoNet Monitor</a></H2>
			<p>The LocoNet Monitor tool displays LocoNet traffic in a
			human-readable form. The last 20 messages are available
			in a scrolling window. Optionally, you can include the
			time the message was received, and/or the raw packet
			bytes. The log information can also be stored in a text
			file.</p>
		    </dd>

		    <dt class=im100w>
			<a href="images/SlotMon.gif">
			    <img src="images/SlotMon.gif"
			         width=100 height=50
			         alt="Command Station Slot Monitor"></a>
		    </dt>
		    <dd>
			<H2><a name="slotmon">Command Station Slot Monitor</a></H2>
			<p>
			The Slot Monitor tool displays a table of the "command
			station slots'" contents. Slots are used to control
			individual locomotives and consists. The display
			includes the decoder's speed step format, current speed
			and function settings, consist information and status.
			You can choose to show either all slots or just the
			ones being actively used.
			</p>
		    </dd>


		    <dt class=im100w>
			<a href="images/SendPkt.gif">
			    <img src="images/SendPkt.gif"
			         width=100 height=50
			         alt="LocoNet Packet Source image"></a>
		    </dt>
		    <dd>
		        <H2><a name="sendpkt">Packet source</a></H2>
		    	<p>
			The Send Packet tool lets you type in a LocoNet packet
			and send it to the layout. You type the packet in
			hexadecimal as pairs of characters, in the same way its
			displayed in the LocoNet monitor.
			</p>
		    </dd>

		    <dt class=im100w>
			         No screen shot available
		    </dt>
		    <dd>
		    <H2><a name="pm4">BDL16, BDL162 and PM4 programmers</a></H2>
		    <p>
			The PM4 programmer and BLDL16 programmer tools provide
			a simple graphic interface for configuring Digitrax
			power and block-occupancy boards. Each "option switch"
			is shown as a checkbox on the screen. You can read the
			current contents from the board, and write your changes
			back easily. There is no need to remove the board from
			the layout, or climb underneath the layout to push
			buttons, as all programming is done via the board's
			LocoNet connection.
		    </p>
		    </dd>


		    <dt class=im100w>
			<a href="images/locoio.gif">
			    <img src="images/locoio.gif"
			         width=100 height=50
			         alt="LocoIO Programmer screen"></a>
		    </dt>
		    <dd>
		    <H2><a name="locoio">LocoIO programmer</a></H2>
		    <p>
		    The LocoIO programmer provides a simple interface for configuring
		    <a HREF="http://www.locobuffer.com/LocoIO.htm">John Jabour's LocoIO board</a>, 
		    a powerful component for building CTC boards and control
		    panels. (More information on the board is available at
		    <a HREF="http://www.locobuffer.com/LocoIO.htm">http://www.locobuffer.com/LocoIO.htm</a>)
		    </p>

		    <p>A LocoIO board has 16 signal pins, each of which can be
		    programmed as an input or output, and to do a number of
		    different things. The board is also sometimes described as
		    having 16 channels.</p>

		    <p>The channels are configured via LocoNet messages. The
		    LocoIO programmer uses a table to represent the
		    configuration of each channel. </p>

		    <p>
		    The "Action" column is used to select how the channel
		    behaves.  Click in a cell to be given a menu of available
		    choices.  Currently, the choices are:
		    <div class=list>
		    <dl>
		    <dt class=left><dfn>"Toggle switch controls turnout"</dfn></dt>
		    <dd class=first><p>
		    Generate a OPC_SW_REQ to close/throw a turnout
		    when a toggle switch changes state.
		    When the input goes high, a "close" command is
		    sent; when the input goes low, a "throw" command is sent.
		    The channel configuration value is 0x0F.</dd>

		    <dt class=left><dfn>"Input low flips turnout"</dfn></dt>
		    <dd><p>
		    Generate a OPC_SW_REQ LocoNet message
		    when the input goes low.  This
		    is intended for use with a momentary pushbutton.
		    The command sent will alternate the  position
		    of the addressed turnout or signal; if "close" 
		    was last sent, a "throw" will be sent now and vice-versa.
		    The channel configuration value is 0x2F.</dd>

		    <dt class=left><dfn>"Input high flips turnout"</dfn></dt>
		    <dd><p>
		    Generate a OPC_SW_REQ LocoNet message when the input goes
		    high. This is intended for use with a momentary pushbutton.
		    The command sent will alternate the  position of the
		    addressed turnout or signal; if "close" was last sent, a
		    "throw" will be sent now and vice-versa.  The channel
		    configuration value is 0x6F.
		    </dd>

		    <dt class=left><dfn>"Status message sets output"</dfn></dt>
		    <dd>
		    <p> Drive an output from OPC_INPUT_REP input status
		    messages on the LocoNet.  The output goes high when an
		    "input high" message is received, and goes low when an
		    "input low" message is received. These messages are also
		    used for block occupancy status; the output will go high
		    when the block is occupied, and low when its empty.  The
		    channel configuration value is 0XC0.
		    </dd>

		    <dt class=left><dfn>"Turnout close cmd sets output"</dfn></dt>
		    <dd>
		    <p> Drive an output on the LocoIO board from received
		    OPC_SW_REQ commands.  The channel configuration value is
		    0x80. This adjusts the address field to look for a command
		    that sets the turnout "closed".
		    </dd>
		    
		    <dt class=left><dfn>"Turnout throw cmd sets output"</dfn></dt>
		    <dd>
		    <p>Drive an output on the LocoIO board from received
		    OPC_SW_REQ commands.  The channel configuration value is
		    0x80. This adjusts the address field to look for a command
		    that sets the turnout "thrown".
		    </dd>

		    </dl>
		    </div>

		    <p>
		    The "Hex Value1,Value2" column sets the address that the
		    LocoIO board will use for LocoNet communications.  This
		    contains a hexadecimal representation of the two
		    configuration values described in John Jabour's LocoIO
		    programming guide.  You generally won't need to figure out
		    these addresses, as the <span class=button>capture</span>
		    buttons will find them for you.

		    <p>
		    We're also planning to have a "User Address" column
		    that will show the human-readable address for turnouts and sensors.
		    For turnout messages, this is the same number that 
		    you would use on your throttle.  For block occupancy
		    messages, this is the block number. For input status
		    messages, this is the input number, which is twice the 
		    number of the associated turnout, plus one if its
		    a DS54 "switch" input.  

		    <p>
		    The <span class=button>Read</span> button reads from the LocoIO board via the LocoNet
		    and shows the current configuration for that pin.
		    The <span class=button>Write</span> button stores the current settings to the LocoIO board.

		    <p>

		    The <span class=button>Capture</span> button provides an easier way to 
		    find a needed LocoNet address.  Configure the input and output
		    for a particular pin, then press the <span class=button>capture</span> button.
		    The address in the next LocoNet message of the right type will 
		    be put in the address column.  
		    <p>
		    For example, if you
		    have a channel set to act when a "Turnout closed status message"
		    is received, press the <span class=button>capture</span> button and use your
		    throttle to command the correct turnout closed.  
		    <p>
		    As another
		    example, if the channel is configured to send a 
		    "Send throw turnout command", press the <span class=button>capture</span> button and use your
		    throttle to command the correct turnout thrown.

		    <p>
		    At the bottom of the table are some general controls.  The 
		    LocoIO address field sets the address of the board being programmed.
		    LocoIO processors are sent with an address of 1051 programmed; see
		    below for how to change that.
		    Address "0" is a global address which any LocoIO board will
		    respond to; make sure you have only one connected when you use that!
		    <p>
		    The <span class=button>Set address</span> button will use the global address to configure a
		    specific address into a LocoIO board.  Again, make sure you have
		    only one connected. (This button is disabled in the current
		    version while we sort out a problem)
		    <p>
		    The <span class=button>Open...</span> and <span class=button>Save...</span> buttons are not yet implemented. They will
		    eventually allow you to load and store configuration files.
		    <p>
		    The <span class=button>Read All</span> and <span class=button>Write All</span> buttons 
		    read or write all of the channels, and are just a convenience.

		    <p>Status messages during capture/read/write are displayed at the
		    bottom of the window.  If no response is heard from the LocoIO
		    unit, the operation will be retried
		    until it succeeds or until you close the window.



		    </dd>
		    </dl>
		</div>

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 1997 - 2004 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

	  </div><!-- closes #mainContent-->
	</div> <!-- closes #mBody-->
</body>
</html>

