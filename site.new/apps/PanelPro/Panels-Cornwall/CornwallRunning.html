<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: CornwallRunning.html,v 1.4 2008-02-10 17:13:31 jacobsen Exp $ -->
<html lang="en">
<head>
    <TITLE>
 	JMRI: Running Nick Kulp's CornwallRR Program
    </TITLE>
    <META content="Bob Jacobsen" name=Author>
    <meta name="keywords" content="JMRI PacketPro Cornwall Nick Kulp CMRI DCC">

    <!-- The combination of "Define" and {Header,Style, Logo and Footer} comments -->
    <!-- are an arbitrary design pattern used by the update.pl script to -->
    <!-- easily replace the common header/footer code for all the web pages -->

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/help/en/html/hardware/index.shtml"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->

    <hr class="hide">

    <div class="nomenu" id="mBody">
	<div id="mainContent">

	    <!-- ------------- -->
	    <!-- Page Contents --> <!-- Required -->
	    <!-- ------------- -->

	    <H1>JMRI: Running Nick Kulp's CornwallRR Program</H1>
		<p class=subtitle>
JMRI was used to create the dispatcher control panel for Nick Kulp's
<A href="http://kc.pennsyrr.com/layouts/kulp/index.html">Cornwall RR</a>.
This page briefly describes how to run that so you can take a look 
at that.
Links to other pages with more detail are included, but many of those pages
do not exist yet or are still under contruction.

<P>
<A href="./images/CornwallPanelLit.gif"><IMG src="./images/SmallCornwallPanel.gif" WIDTH="502" HEIGHT="302" HSPACE="0" VSPACE="0"></A>

<h2><A href="http://kc.pennsyrr.com/layouts/kulp/index.html">The layout</a></h2>
Nick's layout uses a mixture of
C/MRI and DCC.  The block detectors, turnout position sensors, and 
signals are all attached to a C/MRI serial system.  The locomotives
are run using Digitrax DCC.  Some turnouts are thrown manually, and
some are operated by Tortoise motors connected to SwitchIt DCC decoders
and thrown via the Digitrax system.
<P>
The layout has 45 signal heads controlled by the C/MRI system.  Most
have red, yellow and green aspects; there are a couple that also indicate
diverging routes with flashing yellow.  The signals respond to occupancy
to provide an automatic interlocking system.
<P>
Originally, the dispatcher worked via applications on two computers.
One ran the C/MRI system that showed block occupancy and drove the
signals, while another application on a different laptop was used to
throw turnouts.

<h2>The new program</h2>
Nick wanted a computer-based panel for his dispatcher that would
make it easier to run the railroad.  It should clearly show which sections
are occupied, how the turnouts will route the trains, and the appearance
of the signals.  It should also allow the dispatcher to change motorized
turnouts with a click.  And of course, it should look good.
<P>
The most recent version of Nick's program is included as an example
in each JMRI download.  You can install and run it yourself if you'd
like to see what it really looks like and play with the signals, etc.
<h2>Download and install</h2>

The CornwallRR sample program comes with all sufficiently-recent
JMRI/DecoderPro free downloads.  To find out how to download a version
for your specific type of computer, please see the 
<A HREF="../../../download">download pages</a>.

<h2>Starting the program</h2>

Starting the program varies with your computer system:
<UL>
<LI>On a Macintosh, find the "CornwallRR" application icon and double click
it.
<LI>On Linux, run the CornwallRR.csh script.
<LI>On Windows, go to the Start menu. Pull down the programs submenu,
and look for the JMRI group.  Select that group, and then select
the CornwallRR icon.
</ul>

The first time you start the program, it will open a preferences
panel.  From the top, select:
<UL>
<LI>Upper "Layout connection": "CMRI serial"
<LI>Upper "Serial port":        (your com port)
<LI>Lower "Layout connection": "LocoNet Hexfile"
</Ul>
<P>You can leave the rest of the settings at their default values.
Click "Save", and when prompted if you want to quit the program
say "yes".  Restart the program. From now on, it should successfully
run Nick's dispatcher panel in a layout-independent mode.

<h2>Working with the program</h2>
Unfortunately, the download doesn't include Nick's actual railroad, just
the control panel.  So you can't actually run his trains.  But you
can click on the screen to change the program's idea of block occupancy
and turnout positions, and watch how the signals will respond on the actual
layout.
<p>
The occupancy indicators look like 
<IMG src="./images/REDLED.gif"> if the section is occupied, and 
<IMG src="./images/GRAYLED.gif"> if it's not.  If you click on one of these,
it will flip the state.  If you "hover" the mouse pointer over it,
a tooltip will pop up that tells you it's exact name in Nick's
terms (a human-readable "user name"), and in the programs 
naming convention (a 
<a href="../../../doc/Technical/Names.html">"system name"</a>).

<P>
You can also click on many of the turnouts in the black and white
schematic section to flip their state.  (Some of them are not
connected to the C/MRI system yet, and so are inert on the panel).
In some cases, there are several turnouts connected together to form a 
crossing, so flipping one will cause the others to follow.
<P>
Note that the indicators by the levers in the green part of the panel
follow the turnouts in the schematic; this is because they are both
responding to C/MRI readback from the layout, and your clicks are
fooling that into thinking the input has changed (in the absence of
a C/MRI system responding on the serial port).
<P>
If you click on a lever, the lever will flip to the other position
and a DCC command to change the turnout will be sent.  If you're running
this without Nick's layout, however, this command won't actually move
a turnout and send feedback via C/MRI, so the turnout indicator in the
schematic won't change.
<P>
Notice that the signals change in response to the position of turnouts
and occupancy on the schematic.  The program is doing this automatically
by following logic that was copied from Nick's previous programs.
This logic was translated by hand from QBASIC to Java, and embedded in
the Cornwall program.  We're working on more general approaches to this
to make it easier for other people to create their own logic.

<h2>Summary</H2>
JMRI provides tools for creating custom control panels for a model
railroad.  It's flexible enough to do whatever you want, or at least
whatever you're willing to spend the time to create.  For more information
on JMRI see the 
<A HREF="../../../">main web page</a>.  For links to download and 
install instructions for various computer types, see the
<A HREF="../../../download">download pages</a>.
Note that you have to have a recent version (1.1.13 or later) of
JMRI to run Nick's program; the most recent one (whatever it is) is
preferred.

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 1997 - 2004 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->
	  </div><!-- closes #mainContent-->
	</div> <!-- closes #mBody-->
</body>
</html>