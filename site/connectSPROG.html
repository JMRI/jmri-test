<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="Author" content="Bob Jacobsen, LBL; Peter Brandenburg">
  <meta name="GENERATOR"
 content="Mozilla/4.75C-CCK-MCD {C-UDP; EBM-APPLE} (Macintosh; U; PPC) [Netscape]">
  <meta name="Content-Type" content="text/html; charset=iso-8859-1">
  <title>Connecting to an SPROG system</title>
</head>
<body>
<img src="images/logo.gif" align="right" width="160"
 height="135" hspace="0" vspace="0">
<h2>Connecting to an SPROG system</h2>
For more information on the SPROG, please see <a
 href="http://www.sheerstock.fsnet.co.uk/dcc/sprog.htm">the SPROG web
pages</a>. There is a useful <a
 href="http://www.sheerstock.fsnet.co.uk/dcc/sprogFAQ.htm">FAQ page</a>.
<p> Once you have your SPROG assembled and configured (see below),
connect it to the computer's serial port using a 9-pin serial cable. </p>
<p> Then go to the preferences panel of a JMRI-based program.  This
opens automatically the first time a program is run, or you can select
it from the "Edit" menu. </p>
<p> Select "SPROG" from the top selection box. You can then select the
proper serial port in the second selection box. </p>
<p> The series of radio buttons labelled "GUI style" allows you to
select how the program will look. "Metal" is the native Java look
available on all types. Other choices will vary with your computer type.
"Motif", "Windows", "MacOS" and "MacOS Adaptive" look native on Linux,
Windows, MacOS "Classic" and MacOS X respectively. </p>
<p> In the bottom selection box, you can pick the default programmer
format. You can override this each time you open the programmer, so this
is here just for convenience. </p>
<p> Click "Save".  You'll be asked if it's OK for the program to quit,
click "Yes". </p>
<p> Restart the program. You should be up and running.<br>
</p>
<p><span style="text-decoration: underline; font-weight: bold;">
Configuration of SPROG:</span><br>
<br>
SPROG has 3 operation modes: <br>
<br>
- P_mode&nbsp;&nbsp; (programming mode)<br>
- RR_mode&nbsp;&nbsp; (rolling road/test mode)<br>
- B_mode&nbsp;&nbsp; (booster mode) <br>
<br>
To get SPROG working with DecoderPro properly it needs to be setup to
do so with the M and W commands. Fortunately one can use binary values
here, <br>
so it's very easy to determine the right value using a table.<br>
<br>
We need to deselect the ECHO all characters, the RR_mode and the B_mode.<br>
<br>
Example:<br>
<br>
CALC_ERROR = ON and SP128 = ON<br>
<br>
<span style="text-decoration: underline;">Table to establish the
configuration value:</span><br>
<br>
</p>
<table border="1" cellspacing="2" cellpadding="2"
 style="text-align: left; width: 50%;">
  <tbody>
    <tr>
      <td style="vertical-align: top; text-align: left;">Bit<br>
      </td>
      <td style="vertical-align: top;" align="center">15</td>
      <td style="vertical-align: top;" align="center">14<br>
      </td>
      <td style="vertical-align: top;" align="center">13<br>
      </td>
      <td style="vertical-align: top;" align="center">12<br>
      </td>
      <td style="vertical-align: top;" align="center">11<br>
      </td>
      <td style="vertical-align: top;" align="center">10<br>
      </td>
      <td style="vertical-align: top;" align="center">9<br>
      </td>
      <td style="vertical-align: top;" align="center">8<br>
      </td>
      <td style="vertical-align: top;" align="center">7<br>
      </td>
      <td style="vertical-align: top;" align="center">6<br>
      </td>
      <td style="vertical-align: top;" align="center">5<br>
      </td>
      <td style="vertical-align: top;" align="center">4<br>
      </td>
      <td style="vertical-align: top;" align="center">3<br>
      </td>
      <td style="vertical-align: top;" align="center">2<br>
      </td>
      <td style="vertical-align: top;" align="center">1<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Name<br>
      </td>
      <td style="vertical-align: top;">spare<br>
      </td>
      <td style="vertical-align: top;">spare</td>
      <td style="vertical-align: top;">spare<br>
      </td>
      <td style="vertical-align: top;">LONG<br>
      </td>
      <td style="vertical-align: top;">SP128<br>
      </td>
      <td style="vertical-align: top;">SP28<br>
      </td>
      <td style="vertical-align: top;">SP14<br>
      </td>
      <td style="vertical-align: top;">DIR<br>
      </td>
      <td style="vertical-align: top;">spare<br>
      </td>
      <td style="vertical-align: top;">spare</td>
      <td style="vertical-align: top; text-align: center;">B_<br>
      </td>
      <td style="vertical-align: top; text-align: center;">RR_<br>
      </td>
      <td style="vertical-align: top;">CALC_<br>
      </td>
      <td style="vertical-align: top;">VERBOSE </td>
      <td style="vertical-align: top; text-align: center;">ECHO<br>
      </td>
      <td style="vertical-align: top; text-align: center;">MODE<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;">MODE<br>
      </td>
      <td style="vertical-align: top;">MODE<br>
      </td>
      <td style="vertical-align: top;">ERROR<br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top; text-align: center;">_ON<br>
      </td>
      <td style="vertical-align: top; text-align: center;">_SET<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Feature<br>
      </td>
      <td style="vertical-align: top; text-align: center;">allways =0<br>
      </td>
      <td style="vertical-align: top; text-align: center;">allways =0</td>
      <td style="vertical-align: top; text-align: center;">allways =0<br>
      </td>
      <td style="vertical-align: top;">long addr.<br>
      </td>
      <td style="vertical-align: top;">speed steps<br>
      </td>
      <td style="vertical-align: top;">speed steps<br>
      </td>
      <td style="vertical-align: top;">speed steps<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top; text-align: center;">allways =0<br>
      </td>
      <td style="vertical-align: top; text-align: center;">allways =0</td>
      <td style="vertical-align: top;">booster mode<br>
      </td>
      <td style="vertical-align: top;">rolling road mode<br>
      </td>
      <td style="vertical-align: top;">calc. error byte<br>
      </td>
      <td style="vertical-align: top;">verbose mode </td>
      <td style="vertical-align: top;">echo all characters </td>
      <td style="vertical-align: top;">default prog.mode page=0
direct=1 </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Example<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Bits set:<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top; text-align: center;">X<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top; text-align: center;"> X<br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"> <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Value bin<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">1<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">1 </td>
      <td style="vertical-align: top;" align="center"> 0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
      <td style="vertical-align: top;" align="center">0<br>
      </td>
    </tr>
  </tbody>
</table>
<p><br>
This will result in a binary value of: b = 0000100000001000<br>
<br>
To program this into SPROG start a terminal program (like Hyperterm
with WIN) and give SPROG a reset. This will show up the following
screen:.<br>
<br>
SPROG DCC Serial Port Programmer, Ver 1.1a<br>
M S P B R W<br>
P: C V<br>
R: + - &lt; &gt; A F O<br>
P&gt;<br>
<br>
Entering M&nbsp; will return the current configuration (example only!). <br>
<br>
SPROG DCC Serial Port Programmer, Ver 1.1a<br>
M S P B R W<br>
P: C V<br>
R: + - &lt; &gt; A F O<br>
P&gt; M=b0001100000011110<br>
P&gt;<br>
<br>
Now enter M b0000100000001000<br>
<br>
and enter W b0000100000001000<br>
<br>
The last operation will programm the configuration into the nonvolatile
memory.<br>
<br>
Check by entering M , you should see the same value as entered before.<br>
<br>
Now you are ready to operate SPROG with DecoderPro.<br>
<br>
<span style="text-decoration: underline;">Trouble shooting:</span><br
 style="text-decoration: underline;">
<br>
If you fail to get a connection with DecoderPro, check your serial
connection on the SPROG board. It should be made as follows <br>
(all pin locations are for a 9 pin D-SUB female):<br>
<br>
J8&nbsp; -&gt; pin 3 <br>
J9&nbsp; -&gt; pin 2<br>
J11 -&gt; pin 7<br>
J15 -&gt; pin 8<br>
ground -&gt; pin 5<br>
<br>
If still no connection, check if you use a MAX232N serial driver chip.
This one requires1&micro;F Electrolytic caps instead of the specified
100 nF (C 11, 12, 13, 14).<br>
<br>
<br>
<br>
</p>
<hr> <br>
Site hosted by: <br>
<a href="http://sourceforge.net/"> <img
 src="http://sourceforge.net/sflogo.php?group_id=26788&type=1" width="88" height="31" border="0"
 alt="SourceForge Logo"> </a>
<hr> Bob Jacobsen<br>
jake@physics.berkeley.edu
</body>
</html>
