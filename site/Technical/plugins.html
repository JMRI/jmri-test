<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd"><!-- $Id: plugins.html,v 1.1 2003-12-02 07:37:52 jacobsen Exp $ --><html><head>   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">   <meta name="Author" content="Bob Jacobsen, LBL">   <meta name="GENERATOR" content="Mozilla/4.75C-CCK-MCD {C-UDP; EBM-APPLE} (Macintosh; U; PPC) [Netscape]">   <meta name="Content-Type" content="text/html; charset=iso-8859-1">   <title>JMRI Plug-in mechanism</title></head><body><IMG SRC="../images/logo.gif" ALIGN=RIGHT WIDTH="160" HEIGHT="135" HSPACE="0" VSPACE="0" ALT="JMRI logo"><h1>JMRI Plug-in mechanism</h1>The original goal of the JMRI project was to produce a library upon which peoplecould use to build their own applications.  Although some people do that, moreuse the existing applications such as DecoderPro, PanelPro, LocoTools andJmriDemo.  We want to make this more flexible by providing a way to extendthose programs without having to rebuild them from scratch.  This note describesmechanisms for that which will be included in JMRI version 1.4.0<OL><LI>CLASSPATH<P>DecoderPro et al are run via a java command which sets the CLASSPATH andvarious options.  How that's actually done varies with the platform:  cshscripts on Unix, bat files on Windows, application bundles on MacOS X, etc.<P>To make it easy to add plug-ins, these will include the files "jmriplugins.jar"and "lib/jmriplugins.jar" in their CLASSPATH.  <P>If you use that name for the jar file including your code, it will automaticallybe found. You can also put your classes in the "classes" directory of thestartup directory, which is searched first.<P>If some other jar file is necessary, you'll have to edit the startup as needed.<LI>Replacement of existing classes<P>Note that you can directly replace any of the files in the jmri.jar distributionwith your own versions by putting them in a jar file that's searched first.  For example, including a modified version of a .properties file in the jmriplugins.jar file would allow you to include customized versions of menu strings.  This can also be done with a .class file, for example changing the order of menu items by replacing the DecoderPro class.<LI>Plugin classes<P>Replacing a class can cause extra work in the long term, as the replacedclass may be modified as JMRI evolves.  So we also provide a hook on whichto hang new code.  After initialization is complete, the programs willattempt to invoke a static member of the form:<PRE>  class JmriPlugin {     static void start(JFrame mainFrame, JMenuBar menuBar) {}  }</PRE>Note that the JmriPlugin class is not in any Java package!  This methodcan modify the menubar by inserting, modifying or removing menus or menuitems, add buttons to the main panel, etc.  <p>As people use this capability, we'll probably want to refactor some existingclasses to make them easier to extend. For example, a monolithic formattingclass like llnmon should be broken up into smaller pieces to make it easierto add new formats.</OL><HR><BR>Site hosted by: <BR><A href="http://sourceforge.net"> <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> <hr>Bob Jacobsen<BR>jake@physics.berkeley.edu</body></html>