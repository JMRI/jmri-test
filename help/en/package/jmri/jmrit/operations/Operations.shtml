<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id$ -->
<HTML LANG="en">
<HEAD>
<TITLE>Operations</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META CONTENT="Dan Boudreau" NAME="Author">
<META NAME="keywords" CONTENT="JMRI Help Operations Setup Settings Cars Engines Locomotives Trains Routes Locations Schedules">

<!-- Style -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="stylesheet" TYPE="text/css" HREF="/css/default.css"
	MEDIA="screen">
<LINK REL="stylesheet" TYPE="text/css" HREF="/css/print.css"
	MEDIA="print">
<LINK REL="icon" HREF="/images/jmri.ico" TYPE="image/png">
<LINK REL="home" TITLE="Home" HREF="/">
<!-- /Style -->
</HEAD>

<BODY>
<!--#include virtual="/Header" -->

<DIV CLASS="nomenu" ID="mBody">
<DIV ID="mainContent">

<H2>JMRI Operations</H2>

The operations program allows you to create computer generated train
manifests for your railroad. A train
<A HREF="#PrintingManifests">manifest</A> details the work that a train
will perform during an operations session. The manifest provides a list
of car pick up and set outs and shows where the cars are located and
where they should be eventually positioned on the railroad. The program
allows you to build a roster of cars, define locations on the railroad,
and routes for trains to travel. The car roster includes information
about the car, including road name, number, type of car, color, length,
weight, load, date built, and owner. Trains are assigned routes that
define locations where cars can be picked up or set out. Features
include the ability to control what car types, road names, and car loads
a location can service, the available track space for a location, and
the maximum length the train can be between any two locations on the
train's route.
<P>
Locations can have spurs, yards, staging and interchange tracks. Spurs
are used to service industries, and can optionally have custom <A
HREF="#Schedules">schedules</A> assigned to them. Trains can be
configured to require a caboose or car with Flashing Rear End Device
(FRED). The program generates manifests for each train and switch lists
for any location. A <A HREF="#SwitchList">switch list</A> for a location shows the work for all of
the trains that will visit that location. The program can also place
icons representing trains on a JMRI panel. The icon can be taught to
move in the panel along with the train from location to location.
</P>
<P>The operations program is included in the JMRI/DecoderPro suite
of tools and can be found under the main menu heading
"Tools-&gt;Operations".</P>

<P>
<img src="images/MainMenuDecoderPro.png">
</P>

<A NAME="demo"></A>
<H3>Operations Demo Files</H3>

The operations program provides a set of demo files to help introduce
you to the some of the features and capabilities of this program. To
load the demo files, first open the Operations Settings window
"Tools-&gt;Operations-&gt;Settings", and in the upper left corner of the
Setting window is the Tools menu, select "Load Demo Files". The program
will create a <A HREF="#BackupRestore">backup</A> of your current
configuration if you have one, and then loads the demo files. Restart
JMRI to complete the demo load process.

<P>The program also supplies a simple panel to show how the train
icons work. Load the panel before building the trains by selecting in
the main JMRI menu, "Panels-&gt;Load Panels .." a window should appear and
open the "operations" directory and then open the "Operations Demo
Panel" xml file.
</P>

<H3>Quick Start Help</H3>

In the top level menu for JMRI find the "Tools-&gt;Operations" menu. There
are six items in this menu. We recommend that you start with <A
	HREF="#Settings">Settings</A> and work your way down to <A
	HREF="#Trains">Trains</A>. We also recommend that when defining your
locations that you first use yard and spur tracks, and try staging and
interchange tracks when you're more comfortable with how the program
operates.

<P>If this is your first time using a computer generated car forwarding
program, it is best to start off small and gradually work your way
through the various options and features available. Start by entering
only three or four <A HREF="#Locations">locations</A> with each location
having only two or three tracks. Keep things simple and don't modify the
location and track defaults by making them restrictive with regards to
the type of cars or locomotives that they will service. Also, the track and
location default is to allow a train to service the location and track
by trains traveling in any direction. Don't change the defaults until
you can successfully build trains to your liking.</P>

<P>Now enter some <A HREF="#CarsEdit">cars</A> into the operations
database, don't bother entering locomotives for now. Be sure to place the
cars on a track using the <A HREF="#CarsSet">set car location</A>. The
program works best if you keep at least 50% of your tracks empty, so
don't place too many cars on tracks until you understand how the program
builds trains.</P>

<P>Now create a simple <A HREF="#Routes">route</A> for your first
train to follow. Enter each of your locations in the route, and keep it
simple by only entering each of your locations once in the route.  For now
don't modify the route in any way, just use the "Add Location" button.</P>

<P>Now you're ready to create your first <A HREF="#Trains">train</A>.
Be sure to select the route you created for your first train. Leave all
of the train checkboxes alone which means the train will service all car and
locomotive types. Leave the "Option train requirements" for locomotives and caboose area alone for
now. Save the train, close the window, and return to the Trains window.
Press the <A HREF="#BuildingTrains">Build</A> button for the train. It
should build. Now pressing the "Print" or "Preview" button will produce a
manifest for your train. Review the manifest and you should see that the
train serviced all car types. If you examine the <A HREF="#Cars">Cars</A>
window you can see that cars are now assigned to your train.</P>

<P>Now try limiting the car types that the train will service by
modifying some of the car types checkboxes in the <A HREF="#Trains">Edit Train
</A> window. Use the train <A HREF="#TrainReset">reset</A> to release
the cars that were assigned to the train so you can build it again
without moving the train. With the new car types restriction in place,
you should see that the train will only pick up and set out car types that
are selected in the Edit Train window.</P>

<P>Now try restricting your <A HREF="#Yards">tracks</A> to only
certain types of cars by modifying the car types serviced for a track.
Now when you build the train, the train will only set out of cars to tracks
that are willing to accept them.</P>

<P>Press the <A HREF="#TrainMove">Move</A> button located in the <A
	HREF="#Trains">Trains </A> window and you will see that the train's
location will change to the next in the route. You will also see that
the <A HREF="#Cars">Cars</A> window will update to show the cars
serviced by the train moving to their new location as the trains moves
from location to location.</P>

<P>Now enter some <A HREF="#Locomotives">locomotives</A> into the
operations database, and change the train requirements to require one
locomotive. Place some of your locomotives on a track located at the
start of the route. Note that if you want two or more locomotives
servicing your train, that the locomotives must be in a <A
	HREF="#LocomotivesAdd">consist</A>. The last location in your route
must have a track that will service the locomotive <A
	HREF="#LocomotiveModels">type</A> or the build will fail.</P>

<P>If you want a caboose or car with FRED for your train, first
configure some of your cars to be a caboose by selecting the caboose or
FRED <A HREF="#CabooseFredHazardous">checkbox</A> in the Edit Car
window. Now change the Optional train requirements radio button to Caboose or FRED.
Be sure that the last location on your trains route has a track that
will accept the caboose car or the train will not build properly.</P>

<P>If you keep building your first train and moving it, eventually
all of your cars will end up at the last location in your route! Create
another route that is the inverse of your first train. Go to the <A
	HREF="#Routes">Routes</A> window and under the "Tools" menu select
"Copy Route". Select your original route, check the "Invert" checkbox,
enter a name for this route, and then the "Copy" button.  Now create a
second train that uses this route to move cars in the opposite direction
of your first train.</P>

<P>You should now be well on your way with regards to JMRI
operations. Help is also available at the <A
	HREF="http://groups.yahoo.com/group/jmriusers/">jmriusers list</A></P>

<H3>British Railways</H3>

The program supports an alternate set of railway terminology for our
British modelers. To use British terminologies, change the JMRI Display
Locale to English (United Kingdom). With British terminology, trains
travel Up/Down and East/West, and some British railway names and wagon
types are provided to get you started. 

<A NAME="Settings"></A>
<H2>Settings</H2>

The Settings window contains general parameters for the operations
program. Select from the JMRI main window "Tools-&gt;Operations-&gt;Settings"
to open the Settings window. The Setting window has fields and buttons to
allow you to enter your railroad name, the directions your train's
travel, the scale that you are using, printer and icon controls, and the
ability to create backups and restore files for operations.
<P>
<img src="images/Settings.png">
</P>
<H3>Railroad Name</H3>

Enter your railroad name in the field across from "Railroad Name". This
name will show up on your manifests. You can also have a different
railroad name for every train in your roster, see 
<A HREF="#TrainOptions">Train Options</A> for details.

<H3>Train Directions</H3>

If your railroad depicts trains traveling north and south select the
"North/South" box, if your trains travel east and west select the
"East/West" box. You must select at least one direction, and can if
desired select both.

<A NAME="Scale"></A>
<H3>Scale</H3>

Next select the scale you are modeling. This is useful when you enter
the length of cars and tracks. You can enter the number of actual inches
and the program will convert to scale feet. Append a double quote to the
length when entering actual inches. The program will also automatically
assign the proper NMRA weight for a car based on scale and length.

<A NAME="MaximumTrainLength"></A>
<H3>Maximum Train Length</H3>

Now enter the default "Maximum Train Length" you desire for your trains.
This field provides the maximum default train length between cities.
Later you can override this length if you wish a shorter train between
any two locations. A 1000 foot train can carry approximately 20 cars,
and is of course dependent on the car lengths assigned to the train.

<H3>Maximum Number of Locomotives</H3>

Now set the maximum number of locomotives that you want the program to
assign to a train. If you don't want the program assigning locomotives, set
this value to 0.

<H3>Switch and Travel Times</H3>

The program when generating switch lists for the various locations on
your railroad, will estimate the arrival times for your trains based on
the train's departure time and the switch and travel times. Enter the
average number of minutes it takes to set out or pick up a car on your
railroad. Then enter the average amount of time in minutes it takes to
travel from one location to the another.  Later when you create a <A HREF="#EditRoute">route</A>
you will be able to increase or decrease the train's travel time between
any two locations.

<H3>Car Types</H3>

The program has two sets of car types for you to use. Descriptive
provides type names like "Boxcar" and "Tankcar", and AAR provides type
names like "XM" and "T" for boxcars and tank cars respectively. Select
the one that you prefer.  You can add or delete car types by using
the <A HREF="#CarTypeLengthWeight">car type edit</A> window.

<H3>Unit of Length</H3>

   You can use feet or meters when entering the length of your rolling stock and tracks. The program
   will also convert from centimeters to meters when entering car, locomotive, or location lengths,
   just append "cm" to any length.

<H3>Optional Year Modeled</H3>

You can optionally enter the year you want printed on your train manifests.

<H3>Add Operations Menu to Main Menu</H3>

When selected, add the operations menu to the main menu bar. The
operations menu will appear the next time you restart JMRI.

<H3>Close on Save</H3>

When selected, close operation windows when the "Save" button is pressed.

<H3>Panel Options (Train Icons)</H3>

If you want the operations program to place an icon representing the
train on a panel, enter the panel's name (NOT the panel's file path
name!), otherwise leave the name blank to disable. 
Load the panel using the main menu "Panel-&gt;Load Panels..." or use other
load panel options available in JMRI.

<P>The "Enable Train Icon SetX&amp;Y" when selected allows you to
teach the operations program where to place the train icon on your panel
when moving your train from location to location. Deselect this feature
after your done teaching the program to prevent accidentally changing
the train icon's position on your panel. If you also want the lead
locomotive number as part of your train icon text, select the "Append
Locomotive Number" box. You can select the background color of your
train icon depending on the train's direction. Select the color desired
for each direction using the pull down menus. A <A
	HREF="#SwitcherService">switcher</A> is a train with only one location
in its route.</P>
<P>
<img src="images/PanelWithMarkers.png">
</P>

<H3>Save</H3>

When you're finished with the settings window, press the save button to
store the setting in a file called "Operations.xml". You can find this
file in your JMRI directory in a folder called "operations". The program
will also create a backup file each time you press the save button. 

<A	NAME="BackupRestore"></A>
<H3>Backup and Restore</H3>

The "Backup" button will store a copy of the operation files. The
"Restore" button will prompt you to select which set of backup files you
wish to use to recover your operation files. You must quit and restart
JMRI to complete the restoration of the operation files.

<P>When you press the "Backup" button the program creates a new
directory in operations called "backups", and then stores the operation
files in a directory that is based on the day you pressed the "Backup"
button. For example, if today was November 21, 2008, the program will
create a backup directory named "2008_11_21".  You can also rename the
directory to whatever name you want. This would be useful if you had
more than one railroad that you wanted to manage.</P>

<H3>Reset Databases</H3>

To reset the operation databases to their original defaults, use the
Operations-&gt;Settings-&gt;Tools menu and select "Reset Databases". The "Reset Database"
option will make a backup copy of the current operation files before
deleting them. The results will be that the settings, cars, locomotives,
locations, and trains databases will be purged.

<A NAME="SettingsOptions"></A>
<H2>Options</H2>
The operations program has several options that can be modified by
selecting Operations-&gt;Settings-&gt;Tools-&gt;Options.

<P><img src="images/SettingsOptions.png"></P>

<H3>Build Options</H3>

There are two build train options, normal and aggressive. It is
recommended that you select normal when you first begin using the
program. Normal builds guarantee that when a car is delivered (set out)
by a train that there will be track space available for the car.

<P>
Aggressive builds makes the car's track space available as soon as a
car is scheduled for a pick up. Therefore there can be instances where a
train was to pick up a car to vacate the track, but a "later"
train arrives early with a set out to that track and the car hasn't been
picked up. However, more often than not the same train will perform the
pick up and set out thus minimizing the number of conflicts. Aggressive also
performs a two pass determination of car movements. The net effect is
that more cars are moved within a given train. Aggressive also tends to
deliver cars to all of the available spurs. The smaller the spur,
yard, or interchange the more likely that the program will assign cars
to that track.
</P>
<P>
Note that once you've built a train, the build option can not be changed until
all trains are terminated or reset. 
</P>

<A NAME="AllowLocalCarMovements"></A>
<H3>Allow Local Car Movements when using a Switcher</H3>

The next set of options control local car movements when using
<A HREF="#SwitcherService">switcher</A> to service a location.
Normally it is better not to allow a car to move from one spur
directly to another spur at the same location. This type of move can
be very unrealistic, picture moving a boxcar from a shoe manufacture
directly to an auto manufacture. Also moving a car from one yard
track to another can have your operators wondering what kind of busy
work is being generated! But if you need these types of moves, select
the appropriate checkbox. 
			
<A NAME="TypeRoadLoadRestrictionsStaging"></A>
<H3>Enable Type, Road and Load Restrictions into Staging</H3>

The next option is restricting trains to staging tracks that only
accept the train's rolling stock type, road and load names. When "Enable Type,
Road and Load Restrictions into Staging" is selected, the program will only
deliver a train to a staging track has the same rolling stock, road and load
name restrictions. This is useful when you want trains delivered to
staging tracks based on the train's rolling stock restrictions. However,
if you want certain car types, car loads, or road names to be transported by a train,
but not delivered to staging, deselect this feature.

<A NAME="PromptDepartureTrack"></A>
<H3>Prompt for Departure Track from Staging</H3>

If you would like the program to ask you which track a train should
depart from staging during the train build, select this option. Normally
during the train build the program would selected the least
recently used track when determining the track to depart from. Note that the
program will only prompt you if there are two or more trains available
in staging that meet the train's requirements. 

<A NAME="PromptArrivalTrack"></A>
<H3>Prompt for Arrival Track into Staging</H3>

If you would like the program to ask you which track a train should
use when arriving into staging during the train build, select this option. Normally
during the train build the program would selected the least
recently used track when determining the track to arrive on. Note that the
program will only prompt you if there are two or more tracks available
in staging that meet the train's requirements. 

<A NAME="CarRouting"></A>
<H3>Car Routing</H3>

When car routing is enabled, the program will use multiple trains
to deliver a car to it final destination. It is recommended that you
leave this option enabled. With car routing enabled, you can use a <A
	HREF="#Schedules">Schedule</A> to deliver a car to a specific location.
The car routing algorithm will search for the most efficient route for
the car to travel. The algorithm will attempt to use interchanges and
then yards to move cars. Routing through staging is disabled by default.
The algorithm will try and find a route using a maximum of five trains
to complete the car move.  Note that the program never gives up trying to
route a car.  If a car has been assigned a "Final Destination" the program
will try and route the car after every move.

<A NAME="LoggingOptions"></A>
<H3>Logging Options</H3>

If you want the operations program to log your locomotive, car, or train movements to
a file, select the appropriate checkboxes.  The program will create a new
directory called "logger" in the operations directory.  For each day's session
the program will create a new file (.csv) using the day's date.  Use a program like MS Excel
to view the file.

<A NAME="ManifestOptions"></A>
<H3>Options</H3>

If you want to create your own custom manifest using a comma separated value (.csv) file, select
this option.  You can use a program like Excel to create a manifest to your liking.
You can find the manifest files in the operations directory in a directory called "csvManifests".
Each line of the file starts with a two or three letter code, followed by the code's description,
and then any parameters associated with the code. 
Here's a list of the current codes and descriptions:
<P></P>
<table>
<tr><td>Code</td><td>Description</td><td>Parameters</td></tr>
<tr><td>AH</td><td>Add Helpers</td></tr>
<tr><td>AT</td><td>Arrival Time</td><td>Time</td></tr>
<tr><td>CC</td><td>Change Locos and Caboose</td></tr>
<tr><td>CL</td><td>Change Locos</td></tr>
<tr><td>DT</td><td>Departure Time</td><td>Time</td></tr>
<tr><td>DTR</td><td>Departure Time Route</td><td>Time</td></tr>
<tr><td>EDT</td><td>Estimated Departure Time</td><td>Time</td></tr>
<tr><td>LC</td><td>Location Comment</td><td>Comment</td></tr>
<tr><td>LN</td><td>Location Name</td><td>Name</td></tr>
<tr><td>NW</td><td>No Work</td></tr>
<tr><td>PC</td><td>Pick up car</td><td>See below</td></tr>
<tr><td>PL</td><td>Pick up loco</td><td>See below</td></tr>
<tr><td>RC</td><td>Route Comment</td><td>Comment</td></tr>
<tr><td>RH</td><td>Remove Helpers</td></tr>
<tr><td>RN</td><td>Railroad Name</td><td>Name</td></tr>
<tr><td>SC</td><td>Set out car</td><td>See below</td></tr>
<tr><td>SL</td><td>Set out loco</td><td>See below</td></tr>
<tr><td>TC</td><td>Train Comment</td><td>Comment</td></tr>
<tr><td>TD</td><td>Train Departs</td><td>Name</td></tr>
<tr><td>TL</td><td>Train Length</td><td>Length</td></tr>
<tr><td>TM</td><td>Train Manifest Description</td><td>Description</td></tr>
<tr><td>TN</td><td>Train Name</td><td>Name</td></tr>
<tr><td>TW</td><td>Train Weight</td><td>Weight</td></tr>
<tr><td>TT</td><td>Train Terminates</td><td>Name</td></tr>
<tr><td>VT</td><td>Valid</td><td>Month/Day, Year Time</td></tr>
</table>

<P>Time uses the format Hour:Minute.</P>  
<P>The car parameters for pick up car (PC) and set out car (SC) are: road,
number, type, length, load, color, location name, track name,
destination name, destination track name, owner name, kernel name, car
comment, pick up comment, set out comment,C,F,H, RFID, RWE location name, RWE track name. Where C =
Caboose, F = FRED, and H = Hazardous.</P>
<P>The loco parameters for pick up loco (PL) and set out loco (SL) are: road,
number, model, length, type, hp, location name, track name, destination
name, destination track name, owner name, consist name, car comment,
RFID.</P>

<P>You can find some examples of custom manifests at <A
	HREF=http://groups.yahoo.com/group/jmriusers/files/Operations>http://groups.yahoo.com/group/jmriusers/files/Operations.</A></P>

<P>You can also generate custom switch lists using a comma separated value (.csv) files.
You can find the switch list files in the operations directory in a directory called "csvSwitchLists". The csv switch
lists use the same codes and descriptions as the csv manifests, plus the following:
</P>

<P></P>
<table>
<tr><td>Code</td><td>Description</td><td>Parameters</td></tr>
<tr><td>DL</td><td>Departure Location Name</td><td>Name</td></tr>
<tr><td>ETA</td><td>Expected Time Arrival</td><td>Time</td></tr>
<tr><td>ETE</td><td>Estimated Time Enroute</td><td>Time</td></tr>
<tr><td>NCPU</td><td>No Car Pick Up</td></tr>
<tr><td>NCSO</td><td>No Car Set Out</td></tr>
<tr><td>TA</td><td>Train Arrives</td><td>Direction</td></tr>
<tr><td>TDC</td><td>Train changes direction, departs</td><td>Direction</td></tr>
<tr><td>TIR</td><td>Train In Route</td></tr>
<tr><td>TDONE</td><td>Train has already serviced this location</td></tr>
<tr><td>VN</td><td>Visit Number</td><td>Number</td></tr>
</table>

<P>There are two other options, "Enable Value Fields" and "Enable Radio Frequency Identification (RFID) Fields".
You can use these fields to enter the value or cost of your rolling stock and the RFID if you're using them to
track your rolling stock.  You can also rename these fields if you wish and use them for other purposes.</P>


<A NAME="PrintOptions"></A>
<H2>Print Options</H2>

You can modify the how the program prints the train manifests and the amount of detail
that the build report provides.  From the "Operations-&gt;Settings-&gt;Tools" menu select "Print Options" to open
the print option window.
<P>
<img src="images/PrintOptions.png">
</P>
<H3>Manifest Printer Font</H3>

The program supports several types of fonts for printing. Select the desired
font and size using the pull down menus.

<H3>Set Out Text Color</H3>

You can select the text color of your manifest when the operation is to
set out a car or locomotive. Select the desired color from the drop down
box.

<H3>Pick Up Text Color</H3>

You can select the text color of your manifest when the operation is to
pick up a car or locomotive. Select the desired color from the drop down
box.

<H3>Local Move Text Color</H3>

You can select the text color of your manifest when the operation is to
move a car from one track to another at the same location. The car in
this case in not added to the train. Select the desired color from the
drop down box.

<H3>Message Format</H3>

If you would like your manifest and switch lists printed in a tabular format select the
tabular checkbox. This options works best with font names that have
equally spaced characters like "Courier or Monospaced".

<H3>Switch List Format</H3>

You can use the same format as your manifest for your switch lists, or you can customize
your switch lists to your liking.  Deselect the "Same as Manifest" if you want a 
different format for your switch lists.

<H3>Message Formats</H3>

You can customize the pick up, set out, and local move messages for your
manifests and switch lists by selecting the appropriate drop down menus.
To remove an attribute select blank. You can also edit the "[ ] Set out",
"[ ] Pick up" and "[ ] Move" prefixes. If you want to use the text color
options, the set out, pick up, and move prefixes must be unique.

<A NAME="ManifestComments"></A>
<H3>Manifests Comments</H3>

Each location and train route can have an optional comment. You can
print these comments on your manifest if the "Location" and "Route"
check boxes are selected respectively. If you want the manifest to show
how many car loads and empties are in the train, select the "Loads and
Empties" checkbox. You can also use a 12 hour rather than a 24
hour clock format on your manifests and switch lists. And finally, you
can show which train <A HREF="#Timetable">timetable</A> you are using
when building your trains.

<H3>Add Logo</H3>

If you want a logo in the top right hand corner of your manifests and
switch lists, press the "Add Logo" button and select a file with the
image you want to display. You can also have a different logo for every
train in your roster, see <A HREF="#TrainOptions">Train Options</A> for
details.

<A NAME="MisplacedCarsComment"></A>
<H3>Misplaced Cars Comment</H3>

The program provides a comment for your operators to search for 
<A	HREF="#CarsSet">misplaced</A> cars.  You can modify
the comment to your liking.

<H3>Preview Manifest</H3>

If you want to use a text editor to preview your manifests and switch
lists, select this option.

<A NAME="BuildReportDetails"></A>
<H3>Build Report Details</H3>

   You can adjust the amount of information that the build report will show. Select one of the four
   levels using the radio buttons in the Print Options window. The program when generating the build
   reports stores the "Very Detailed" information to disk. The radio buttons control how much of
   that data is actually printed. The "Minimal" radio button provides the least amount of
   information and "Very Detailed" provides the most. If you're only interested why a train won't
   build, the "Minimal" setting can provide you with this information. The "Normal" setting shows
   the train's route and requirements, along with the choices the program makes for setting out
   locomotives and cars. The "Detailed" provides additional comments about the build and shows all
   of the available cars for the train. The "Very Detailed" setting produces the most pages, and
   will show why cars are excluded from the train, and why they are not picked up or set out. Be
   sure and press "Save" after changing the build report selection. 
   
   <P>
   You also have the option of using a text editor to view your build report.  A text editor can make
   trouble shooting a problem much easier for you.  For example, say you have a car that isn't moving.
   Using the editor's find feature, you could search the build report using the car's road number
   and quickly find why the car isn't being picked up by the train.
   
<A NAME="Locations"></A>
<H2>Locations</H2>

Locations are places on your railroad that trains visit to pick up or
set out cars and locomotives. Locations can be cities, towns, or just
places where trains need to work cars. Select
"Tools-&gt;Operations-&gt;Locations" to add or edit the locations on your
railroad. 

<P>
<img src="images/Locations.png">
</P>
<P>
To add a location, press the "Add" button located on the
bottom of the "Locations" window. A new window should appear. 
</P>
<P>
<img src="images/EditLocation.png">
</P>

<P>In the "Add Location" window, enter the name of the location in
box across from "Name". The location name must be unique; the program
will not allow two locations with identical names. However, if you want
more than one location to have the same name for your manifests and
switch lists, add a hyphen and a number to the locations name. For
example, "Boston-1" and "Boston-2" will print as "Boston". The program
will remove the hyphen and number when printing manifests and switch
lists.</P>

<P>Now press the "Add Location" button at
the bottom of the window. The various fields that were disabled should
now appear.
</P>
<P>Each location can have several <A HREF="#Yards">yard</A>, 
<A HREF="#Sidings">spur</A>, <A HREF="#Interchange">interchange</A> or
<A HREF="#Staging">staging</A> tracks. Yards are where cars and locomotives are placed for
temporary storage. A spur can be an industry or any place where a car
is loaded or unloaded.  An interchange track is used to exchange cars
between trains, or to create a classification yard which is used to build
trains.  Staging tracks represent distant locations where trains can travel between to service
the layout.

<P>
For a train to service a location, there must be
at least one track for that location. See below how to add tracks to
your location.</P>
<P>The tables show the length of the tracks, the amount of track
that is occupied (Used) by cars and locomotives, the total number of cars
and locomotives (Rolling Stock) at each location, the number of cars and
locomotives that will be picked up (Pick ups) by trains, and the number of
cars and locomotives that will be delivered (Set outs) by trains.</P>

<H3>Location Service Direction</H3>

You can decide which train direction the location can service. For
example, if only east bound trains can access the location select
"East" and deselect the other directions. This can be useful if you
want to only support trailing point switching for a given location. If a
location can support multiple directions then select the ones that are
appropriate.

<H3>Location Rolling Stock</H3>

You can control the rolling stock a location can service. Press the
"Clear All" button to deselect all types, or "Select All" to select all
types, then select or deselect the rolling stock you wish the location
to accept. After configuring the tracks for a location, you can use the
"Auto Select" button to have the location reflect the rolling stock
serviced by the various tracks.

<H3>Location Comment</H3> 

You can enter an optional comment for your location.  If you want the comment
to print on your manifests you must select the print location comments
<A HREF="#ManifestComments">option</A>.

<A NAME="Yards"></A>
<H3>Yards</H3>

A yard is used to store cars and locomotives. A car's load status
does not change when delivered to a yard track. To add a yard, select
the "Yards" radio button and then press the "Add Yard Track" button.

<P>
<img src="images/AddYard.png">
</P>

Now enter the name of
the yard along with the length of the track in scale feet or in actual
inches. Append a double quote (") to the length when entering actual
inches and the program will convert the length into scale feet. Append
cm if you want to convert from centimeters to meters. Press the "Add
Yard Track" button at the bottom of the window and the disabled fields
should now appear.

<H3>Rolling Stock Serviced</H3>

You can control what type of rolling stock the yard can service. Note
that the yard rolling stock is restricted to the ones that the location
can service. If the rolling stock that you wish doesn't appear for a
yard, confirm that the location's rolling stock types are properly
selected. If the rolling stock type you want doesn't exist for a
location, you will have to create the type using the "Cars" window, see
<A HREF="#Cars">Cars</A> below.

<H3>Road Names Serviced</H3>

You can also restrict which roads a yard can service. Select "Accept
Only" if you want to build a list of road names that the yard will
accept. Select "Exclude" if you want to build a list of road names that
you want to exclude from the yard.

<H3>Load Serviced</H3>

You can also restrict which car loads a yard can service. Select "Accept
Only" if you want to build a list of car load names that the yard will
accept. Select "Exclude" if you want to build a list of car load names that
you want to exclude from the yard.

<H3>Pick Up Car Order</H3>

There are three options for picking up cars from the yard. "Normal" uses
the car's move count to determine the order cars are removed from the
yard, "FIFO" (First In First Out), and "LIFO" (Last In First Out).  LIFO is
useful if you have a single ended yard that you use to service cars.  For
example storing empty coal cars, it would make more sense to pull an empty
coal car from the front of the line rather than digging one out from the middle of
the yard.

<H3>Comment</H3>

You can enter an optional comment for the yard.

<H3>Save Yard Track</H3>

Press the "Save Yard Track" to save your work. The program will create a
file (OperationsLocationRoster.xml) in your JMRI directory in a folder
called "operations". The program will also create a backup file
containing the last settings for all of your locations. 

<A NAME="ChangeTrackType"></A>
<H3>Change Track Type</H3>

If you want to change the track type to a spur, interchange or yard, in the edit track
window, select Tools-&gt;Change Track Type.  Select the desired track type and press "Save".

<A NAME="Pools"></A>
<H3>Pools</H3>

The program allows you to "pool" a set of tracks at a location. Tracks
in a pool share their track lengths with each other. This is useful if
you've divided a location into track segments and you want each segment to
adjust its length based on the program's demands. To create and place a
track into a pool, select Tools-&gt;Pools in one of the track edit
windows. Enter a name for your pool and press the "Add" button. You can
also specify the minimum length for the track. A minimum track length
prevents the other tracks in the pool from acquiring all of the track's
length. Next select a pool name for the track and press "Save". The
bottom of the pool window will show the other tracks that are in the
track's pool. 

<A	NAME="Sidings"></A>
<H3>Spurs</H3>

A spur is used to service an industry. To add a spur, press the "Add
Spur" button. Spurs are very similar to <A HREF="#Yards">Yards</A> ,
so see above for more information. You can if you wish schedule the
order that cars will be delivered to a spur, or demand cars with
certain loads. See <A HREF="#Schedules">Schedules</A> below for more
information. 
<P>When a car is placed at a spur the car's load status is modified.  The program
provides two load names for all cars, the default empty or "E", and the default load
or "L".  If a car has one of these loads when it arrives at a spur, the load name
will change to the other, i.e. "E" becomes "L" and "L" becomes "E".</P>

<A NAME="Schedules"></A>
<H3>Schedules</H3>

If you would like to see cars delivered in a particular sequence, or
with a specific load for delivery or shipping, the program allows you to
apply a schedule to a spur. This is an optional feature and shouldn't
be used until you become very familiar with how the program generates
manifests and switch lists. A schedule provides very fine control on the
order types of cars will be delivered to a spur. You can also specify
the road name for the type of car delivered. For example, if you wanted
two SP boxcars to be delivered followed by a tank car loaded with "Oil",
you can create a schedule that will do exactly that. To create a
schedule press the "Edit" button next to "Optional Schedule" pull down 
menu on the "Edit Spur Track" window. Pressing the
"Edit" button should create the "Add Schedule" window.
<P>
<img src="images/EditSchedule.png">
</P>
<P>Enter a name for your schedule and press the "Add Schedule"
button on the bottom of the window. Multiple spurs can use the same
schedule as long as the spurs use the same car types and roads. Now
add your first delivery for this spur by selecting a car type in the
menu box found in the lower left corner of the window and pressing the
"Add car type" button. A new item should appear in your schedule
containing the type of car, a pull down menu for road names, and a count
of 1. You can if you wish specify a particular road for the type of car
you entered, or leave it blank if you don't care about the road name.
You can also specify the car load received and shipped. You can also
control if the car will be delivered during the session. Select from the
"Timetable" pull down menu the train timetable you want. When a train timetable
is selected, a car will only be delivered when that train timetable is active.
See Trains-&gt;Tools-&gt;<A HREF="#Timetable">Timetable</A> to select
the train timetable for your session.</P>

<P> If you wanted more than one car type to be delivered consecutively,
increase the count to the number that you wish. The maximum count is 10
and the minimum is 1. In the schedule shown above, the schedule is requesting two
SP Boxcars in a row, then a TankOil car with with a load of "L(Oil)".  After
the TankOil car is delivered the schedule starts from the beginning, again requesting
two SP Boxcars followed by a TankOil car.
The wait field allows you determine how many trains
will visit the location before picking up the car.  Useful if you want
a car to remain still for several operating sessions.</P>

<P>Repeat selecting the car types and pressing to
"Add car type" until your have a delivery schedule you like. Press "Save
Schedule" and close the schedule window when you are done.
Note only car types and roads that are accepted by this spur
are available. If a car type or road isn't available, check the car
types and roads for this spur and location.
</P>
<P>The schedule controls when and what cars will be delivered and the car
order. It makes the spur more restrictive, only cars demanded by the 
schedule will be delivered to the spur. Looking at the schedule you
will see a pointer in the table under the heading "Current", the pointer
shows the
next car type that the program wants to place at the spur. When
the program finds that car and sets the car's destination to this
spur, the pointer will move the next item in the schedule.  After servicing
the last item in the schedule, the pointer will return to the first item
in the schedule.</P>

<P>If you want custom <A HREF="#CarLoad">loads</A> for your cars,
you can create them using the <A HREF="#EditCarLoads">Edit Car
Attributes</A> for car "Load". Each new load is associated with the car
type. For example you can have "Screws" for a boxcar, and "Oil" for a
tank car. The program will deliver cars with a custom load to a
spur that has a schedule that also requests that particular load.
However, cars with a custom load can still be placed at yards,
staging, and interchanges.</P>

<P>You can if you wish, specify the final destination for a car once
it has been serviced by the spur. Only destination tracks that can
accept the car type are shown in the track pull down menu.</P>

<P>You can optionally use your <A HREF="#StagingAndCarLoads">staging
tracks</A> to empty cars with a custom load, and you can also optionally
have the program place custom loads into cars using staging tracks. If
you want to specify staging as the car's destination, do not select a
track, let the program determine which is the appropriate track in
staging to use. Otherwise, if you did select a track, that track would
become unavailable for other cars. To prevent overloading a spur with
cars with custom loads from staging, the program will normally limit the
number of cars in route to a track with a schedule to the available track space. So
if you have space for three cars, the most the program would normally
generate for you from staging is three cars. However, if you need to
adjust the number of cars in route to a spur with a schedule, select
in the edit schedule window "Tools-&gt;Options". A new window should
appear, and adjust the "Percentage of custom loads generated by
staging". The default value is 100% which means only generate enough
cars to fill 100% of the available track space. If you only want half of
your car loads to come from staging, set the value to 50%, and if you
don't want staging to ever generate a custom load car for the spur,
set the value to 0%. Sometimes it is appropriate to overload a spur
with cars, if you want this, increase the value up to 1000%. BTW 1000%
means send 10 times the available space in cars to this spur. If you
enter this value, you hopefully have 10 times the spur's available
track space in a storage yard that is near by!</P>

<P>Schedules can operate in one of two modes, sequential as
described above, or in match mode. Match mode eliminates the sequential
aspects of a schedule. In match mode, the program will search the entire
schedule to find a car type and load that matches the car that the
program is trying to place. In match mode the pointer shows the last car
that the program found acceptable for the spur. To change the schedule
to match mode, select "Match" in the edit schedule window
and press "Save". Match mode is useful when the order
cars arrive isn't important, but you still want to ship cars with a
specific load, provide the car's final destination, or have the car wait
for a specific number of trains at the spur. In match mode the
schedule item count is ignored as it isn't used. All of the other fields
are available, and you can have the same type of car several times, with
each item in the schedule looking for a specific receive load. Also in
match mode the car type selection box advances automatically to the next
car type when adding a car type. This makes it easy to quickly add car
types to the table.</P>

<P>You can also access your schedules from the Locations Tools menu.
The Schedules table provides status for each schedule. Since you can
assign a schedule to multiple spurs, the table also provides
additional status for each of the spurs that use that particular
schedule. The table also allows you the edit a schedule once its been
assigned to a spur.</P>

<A	NAME="SchedulesAndLoads"></A>
<H3>Schedules and Loads</H3>

You've entered all of your cars, tracks, and trains and have been
playing with the program for awhile. You're happy with where the cars
end up, but watching the car movements generated by the program over
several sessions has you thinking that it would be nice if the car
movements had a "purpose". What you would like to see is a series of car
moves that mimic the prototype railroad that your modeling, or maybe you
just want the cars to move in a certain sequence. Schedules and custom
car loads is the trick to getting the program to do what you want.

<P>The program provides every car with two loads, an "L" and "E".
These are called the default load and empty respectively. You can't
delete them, but you can rename them if you wish. For every car type,
you can create additional loads. For example, let's say you have an
industry that needs paper loaded in boxcars. You could create this <A
	HREF="#EditCarLoads">load</A> for your boxcars and name it L(paper).
Now at the spur that serves your paper industry, you need to create a
schedule. In this schedule, the first item you enter is a boxcar, and
then select as the receive load, L(paper). If the train that services
this industry departs from staging, you're basically done. The program
when building a train from staging, will search for an empty boxcar, and
if found, will create the load L(paper) for you. Once the car's load is
created for that industry, the program will set the car's destination to
that industry. When the car gets delivered, the program will remove the
paper load, and the car's load status will become empty or "E".</P>

<P>That was easy, so let's make things more interesting and have the
industry ship some printed materials. We'll create and call this load
L(print). Now in the first schedule item, instead of leaving the menu
under "Ship" blank, select L(print). Next to the ship menu are
destination and track menus. We could select a destination that is
staging. No need to select the track, just the staging location. Now
when a train returns to pick up the boxcar, its load will be L(print)
and when the car gets to staging, the load will be removed and the car's
load status will return to empty or "E".</P>

<P>We could have instead of sending the car with print to staging,
to a spur. Just select the destination and spur that you want the
car go to. Even if it takes several trains to get the car there, the
program will figure out the best route. Now if you create another
schedule at this spur, you could forward the car again. By stringing a
series of schedules and loads together you can create any car sequence
you want.</P>

<P>Another interesting way to move cars is to ship a custom load,
but not specify a destination. The program when it finds a car with a
custom load, but no destination, will check every spur to see if
there's a schedule demanding that car type with that specific load. And
if there is a spur that meets the requirements, the program will route
the car to that industry. But once a car has a custom load, that car can
only move to yards, interchanges, and staging. No spurs unless the
spur also has a schedule demanding that car and load.</P>

<P>One more consideration is empty cars. The program doesn't route
cars with the default loads "E" or "L". So if your schedule is
requesting an car with the empty default "E", it can take awhile before
that car shows up. An alternative is to handle empty cars like cars
with custom loads. You could create the custom load "E(mpty)" and use
this load to signify an empty car. Now cars with this load will be
routed and will have the same characteristics as cars with the "other"
custom loads.</P>

<A	NAME="Interchange"></A>
<H3>Interchange Tracks</H3>

If you want the program to force the exchange of cars between trains you
need to define an interchange track. Cars dropped off to an interchange
track by a train on a given route will not be picked up by any train
using that route. Another train with a different route is required to
pick up the cars. For example, you might have a branch line that picks up
and set out cars from a terminal. By defining the track as an
interchange, once the branch line train delivers the cars, they will remain
there until the main line train stops to service the terminal's
interchange track.

<P>The car's load status does not change when placed at an interchange track.</P>

<P>If you want more control on how your interchange track will
operate, you can optionally specify a train or route to pick up or set out
cars at an interchange track.</P>

<H3>How to Create a Classification Yard</H3>

A classification yard is used to sort cars into various trains. Normally
a yard track is assigned to a specific train and cars are delivered to
that track until there are enough cars to complete a train. To create a
classification yard, you need to assign an <A HREF="#Interchange">interchange
track</A> to each of the trains that will depart your yard. For each
track, allow any train to set out cars, but assign only one train to
pick them up. You should configure the interchange track to service the
same car types and roads that the train services, otherwise you could
end up with orphan cars.

<P>Note that it is okay to create more interchange tracks then there
are physical tracks in your classification yard. The cars can share the
same "slough" track until its time to finally sort them into their
various trains.</P>

<A NAME="Staging"></A>
<H3>Staging Tracks</H3>

Staging tracks are normally used to represent locations that generate traffic to and from your
layout. Many times physical access to staging tracks is limited, therefore the program places
significant restrictions on how staging tracks are used.

<P>
<img src="images/EditStaging.png">
</P>

A staging track allows you to have all cars and locomotives in a train
delivered to one track. When terminating a train into staging, the
program will search for a completely empty track, one with no locomotives or
cars. The staging track by <A HREF="#TypeRoadLoadRestrictionsStaging">default</A> must
also service all of the train's car and locomotive types and roads. Trains
can not share staging tracks; the program will only place one train per
track. When departing a location with a staging track, all cars and
locomotives on one track will be assigned to the train. A location can have
multiple staging tracks, but can't have any other types of tracks,
spurs, yards, etc. Staging tracks can be at the start of a route, the
end of the route, or both. Staging tracks in the middle of a route are
ignored by the program.

<p>Note if you are running a train to and from the same staging
location, you must define two staging tracks for the program, one to depart
on and one to return on. Physically the two staging tracks can be the
same one. If you want to use the same name for your staging tracks, the
program allows you to name the staging tracks using a hyphen and a
number as a suffix. The hyphen and number are not printed on the switch
lists or manifests.</p>

<P>If you require a train leaving staging to have a certain number
of locomotives, locomotive model, or road name; the program will search all
staging tracks at the departure location for a train meeting those
requirements. If you set the locomotive requirements to 0, the program will
select the next available train from staging; and will ignore the number
of locomotives leaving that staging track. See <A HREF="#TrainRequires">Optional Train
Requirements</A> for more info.</P>

<P>You can if you wish, optionally control which staging tracks a
train will arrive on and depart. Note that the default "Any" allows any
train to arrive or depart on the staging track, so if you want to
restrict a train to a specific track or tracks, you must configure all
of the staging tracks at that location.</P>

<P>You can as an <A HREF="#PromptDepartureTrack">option</A>, have
the program ask you which track you want to use when departing from,
or arriving into staging.</P>

<A	NAME="StagingAndCarLoads"></A>
<H3>Staging and Car loads</H3>

Staging tracks can optionally swap the car default loads from empty to
loaded, and loaded to empty. Select the "Swap default Loads and Empties"
if you want your cars loads to change when arriving at the staging
track. You can if you want, ask the program to empty cars as they
enter staging. Select the "Empty cars with default loads" to change a
car's load status to empty. If you're using custom loads, you can remove
the custom load when the cars arrive at the staging track. Select the
"Empty cars with custom loads" box if you want to replace your custom
loads with the default empty.

<P>The program provides two options for placing custom loads into
cars when they depart staging. The first option is called "Generate
custom loads for spurs serviced by this train". If the first option is
selected, the program will only check spurs with schedules along the
departure train's route. The program will only generate enough car loads
to fill the spur's track. When only the first option is selected, the program
ignores the schedule's "Percentage of custom loads generated by staging"
and the "Alternate Track" optional features.</P>

<P>If the second option is selected, "Generate custom loads for any
spur (multiple trains)", the program will check all spurs with a
schedule for a request. The program when determining now many car loads
to generate, will consider the value in the "Percentage of custom loads
generated by staging". Also, if the spur is full or becomes full, the
program will send cars to the "Alternate Track", and then to any yard
tracks at the spur's location.</P>

<P>Both options work the same with regards to placing custom car
loads into cars, only the number of cars loaded and the number of
spurs considered by the program changes. If a schedule demands a
certain car type, and that car type is departing staging, and the car's
load is default empty, the program will place the custom load into that
car if the appropriate option is selected.</P>

<P>For a spur to request a custom load, the spur must have a <A
	HREF="#Schedules">schedule</A>.</P>

<P>To restrict which loads the program will place into your cars,
you can use the staging tracks load service control feature. See "Select
loads serviced by this track" when editing the staging track. You can
also restrict which types of loads the program will place by restricting
the types of loads the train departing from staging is allowed to
service. See "Select loads serviced by this train" under Edit-&gt;Train,
then Tools-&gt;<A HREF="#TrainBuildOptions">Train Build Options</A>.</P>

<H3>Blocking Cars from Staging</H3>

The program provides a very simplistic algorithm to block cars from
staging. Since cars that have been sent to staging can reside
anywhere in the train, the program uses the last location where the
cars where picked up to block an outgoing train from staging. So for example, if
a train that terminated into staging had three stops, A, B, and C, 
the cars from A would be blocked together when the next
train departed staging. The same goes for previous pick ups from B and C,
those cars would remain together. The program when attempting to find
destinations for the cars departing staging, starts with the largest
block of cars, and then checks the departure train's route, and attempts to send the
largest block to the location requesting the most moves. After doing
that, the program does the same with the next block of cars, it finds
the second location in the route and sends the cars there. This is a
very simplistic approach to blocking cars, it assumes that cars previously
picked up at a location were placed into the train as a group. This
blocking feature doesn't consider where in the train the cars are, as
some operators when picking up cars, will add the cars to any part of
the train. So the first stop in the departure train's route may not have the
cars at the head of the train, but they should be in a group,
somewhere in the train. The first time you depart staging with this
feature on, the cars will not be blocked for you, you need to first
terminate a new train into staging, those cars will have the blocking
tags assigned to them. To enable this feature, see Edit Staging
Track, "Optional Car Blocking" in the lower right corner of the
window.  There are many reasons why this option will not block cars
correctly.  See the train's build report for more details.

<H3>Looping Trains through Staging</H3>

Sometimes for operations a train enters staging at one location (call it
A) and then later departs at another location (call it B). From an
operations perspective locations A and B are locations not directly
connected by trains. So we need to relocate locomotives and cars from
location A to B so the train's manifest can make sense. One way to do
this is to terminate the train into staging at location A. Then create a
"virtual" train that simply moves the cars from location A staging to
location B staging. Doing this causes the program to "move" the train
and its cars from A to B which is really the same physical track. Later
you can build a train that departs location B, and the manifest will
show that the train originated from B and not A.

<p>You can automate the restaging of a train by creating a <A
	HREF="#TrainScripts">script</A> that is activated when the train is
terminated into staging.</P>


<A NAME="ModifyLocationsByCarType"></A>
<H3>Modify Locations by Car Type</H3>

This tool can be found under Locations-&gt;Tools. Use this tool to quickly
modify the type of cars your locations and tracks will service. Very
useful when adding a new car type to your roster.

<P><img src="images/ModifyLocationsByCarType.png"></P>

<P>First select the car type you wish to modify. The window will
then show which locations and tracks can service that car type. Select
or deselect the locations and tracks you want to service, and press the
"Save" button to modify your locations and tracks. You can also copy how
an existing car is serviced by your locations and apply those rules to
another car. To make a car type behave like another, first select the
car your would like to copy, then select the "copy" checkbox, the car
type will now appear to the right of the checkbox, then select the type
of car you want to modify, and press "Save" to have both car types
serviced by the same locations and tracks.</P>

<A NAME="Cars"></A>
<H2>Cars</H2>

The cars window allows you to edit your car roster. You can enter a car's
number, road, type, length. The program will automatically calculate the
car's weight based on length and the scale your modeling. You can
optionally add the car's color, build date, load and owner. If you want
a group of cars to be switched as a unit, you can create a "kernel". You
can assign any number of cars to a kernel but the type of the first car
assigned will be used by the program to determine if the kernel is
allowed at a location. The entire length of the kernel is used to
determine if the cars in the kernel will fit. Note that the program also
includes space for the car's couplers when calculating the length of a
kernel.

<P>
<img src="images/Cars.png">
</P>
<H3>Add, Save, Find Buttons</H3>

There are three buttons located at the bottom of the Cars window. The
"Add" button allows you to add a car to your roster. The "Save" button
stores the cars roster to disk. It also saves the Cars window position
and size, and any changes you made to the table widths.  The "Find" button
and the adjacent text window can be used to find a car by its road number.  You
can use the wild card "*" when entering a car number.  For example if you
want to find all cars with numbers that ended with 345, enter *345, and press
find.  Each time you press find, the next car with a road number ending with
"345" will be highlighted.

<P>
<A NAME="ImportingCars"></A>
</P>
<H3>Importing Cars from a File</H3>

If you already have a list of cars in a database, you can import the
cars into the program. The import function requires an ACSII text file,
with one line for each car. The car import requires four attributes and
the order is car number, road name, type, and length. All four
car attributes are required for the import to work correctly. The
following shows two examples of the correct format:

<P>336 GCR Flat 40
 <BR>655578 UP Boxcar 40</P>

<P>Each line can start with a space and multiple spaces between
fields is okay. Optionally you can include additional attributes in the
following order, weight, color, owner name, date built, and location. The location can
have two fields, the location name followed by the location's spur or
yard name separated by a hyphen. The following shows two examples of the
correct format:</P>

<P>336 GCR Flat 40 3.8 Black AT 1930 Home Town USA - George's Oil Terminal
<BR>655578 UP Boxcar 40 3.8 Yellow DB 1934 York - York Freight</P>

<P>If you prefer to use comma delimiters instead of spaces, use a file with
a .csv extension or place
the word "comma" at the start of your import file and use commas instead
of spaces. The following are two examples of importing cars with comma
deliminters.</P>
<P>comma <BR>
336,GCR,Flat Car,40,3.8,Black,AT,1930,Home Town USA,-,George's Oil
Terminal <BR>
655578,UP,Tank Car,40,3.8,Yellow,DB,1934,York,-,York Freight</P>
<P>You need to be very careful with spaces when importing a comma
delimitated file. The program will include leading and trailing spaces
if they exist between the commas.</P>

<P>If you enter 0 for the car's weight, the program will automatically calculate the
car weight for you based on the car's length and the <A HREF="#Scale">scale</A> you've selected.</P>

<P>To import a file, use the "Tools" menu in the upper left hand
corner of the Tools-&gt;Operations-&gt;Cars menu. Then select
"Tools-&gt;Roster-&gt;Import from file". Note that the program will only
add cars that don't exist in the program's car roster. It the car
already exists, the import will be skipped by the program.</P>

<P>During the import, if a car's location or track doesn't exist in
the program's database, the program will prompt you to create them. This
way not only are you importing your cars, but also the car's locations
and tracks. The program will set new track to a length of 1000', and
will set the track type to yard. After the import you can edit the track
and set the track's correct length and <A HREF="#ChangeTrackType">type</A>.</P>

<P>To improve the speed of the car import, you can close the cars
window. It takes significantly more processor cycles to update the cars
window than to actually import the cars.</P>

<P>After importing your cars, you must save them if you want to keep
them as part of your roster. Use the Cars "Save" button or select any
car by pressing the edit button and then press the "Save" button that
can be found at the bottom right of the "Edit Car" window.</P>

<A NAME="CarsEdit"></A>
<H3>Adding Cars to your Roster</H3>

To manually add a car to your roster, press the "Add" button located at
the bottom of the "Tools-&gt;Operations-&gt;Cars" window. 

<P>
<img src="images/EditCar.png">
</P>
<P>

Then select the road
for the car. If the desired road doesn't exist, press the "Edit" button
across from the road select menu box. This will allow you to add a new
road or delete any that you don't need.</P>

<H3>Road Number</H3>

Now enter the car's number in the text box. The program requires a
unique road name and road number for each car. If you have cars with
identical roads and numbers, simply add a -1, -2, etc. to each of the
car numbers. The program when printing out the manifest or switch list
will drop the -1, -2, etc. from the car's road number.

<A NAME="CarTypeLengthWeight"></A>
<H3>Car Type, Length, Weight</H3>

Select the car's type and length from the menu boxes. Use the
"Edit" button to add or delete car types, or lengths that you
want to add or remove. The car's weight is automatically calculated, but
you can enter a different weight if necessary. When entering the length
of a car, enter the length of the body and not the total length. For
example, a forty foot boxcar has a length of 40 feet. The program when
calculating lengths will add two feet to each end of a car for the
couplers. Therefore when you place a forty foot car at a spur, it will
consume 44 feet of track.

<H3>Car subType</H3>

<P>The program supports the ability to add a subType to
your car types. Adding a "-subType" to your car type will create a new
type of car. The "-subType" is not printed on the manifest or switch
lists. For example you might have coal cars with loads and coal cars
that are empty. If you enter the car type as HopCoal-C for your cars
with coal, and HopCoal-E for the empties, the program can use this
information to assign and deliver cars to their appropriate trains and
locations respectively.</P>

<A	NAME="CabooseFredHazardous"></A>
<H3>Passenger, Caboose, FRED, Hazardous Checkboxes</H3>

If the car is used in passenger service select the passenger checkbox. The
program will place passenger cars towards the rear of a mixed service
(combination of passenger and freight cars) train. If the car is a
caboose, has a FRED (Flashing Rear End Device), or is hazardous, select
the proper checkbox. The program uses the caboose and FRED functions to
place the car at the end of a train when the train requires a caboose or
car with FRED. The hazardous checkbox will cause the program to add a
note to the switch list that the car is transporting hazardous
materials. Your railroad's policy regarding hazardous materials can than
be applied to this car!

<H3>Car Location</H3>

Now set the car's location on the layout. If the car is off the layout,
set the location to none (blank space).

<A	NAME="CarLoad"></A>
<H3>Car Load</H3>

You can optionally set the load state of the car. Select E for empty or
L for loaded. You can also create your own custom <A HREF="#EditCarLoads">car loads</A>,
but there are restrictions. Normally spurs with <A HREF="#Schedules">Schedules</A> are used to
load or unload cars with custom loads that you've created. You can also use
<A HREF="#StagingAndCarLoads">staging tracks</A> to load or unload your car with custom loads.
It is also suggested
that you use a format similar to L(commodity) to describe your loads.
For example a load of tools could be entered as "L(Tools)" or just "Tools" if desired.

<A	NAME="Kernel"></A>
<H3>Kernel, or Group of Cars</H3>

If wish this car to be part of a kernel which is a group of cars that
you want to switch as one unit, press "Edit" across from "Kernel" and
enter a kernel name. Then select the kernel from the menu box.

<H3>Optional Fields</H3>

Finally you can optionally enter the color, build date, owner and comment for
this car.  The build date can be entered as a four digit year, or in the format of
month-year.  

<H3>Save</H3>

Press "Save" to store the car's settings. The program will create a file
(OperationsCarRoster.xml) in your JMRI directory in a folder called
"operations". A backup file with the last settings for all of your cars
is also created each time the "Save" button is pressed. 

<A	NAME="EditCarAttributes"></A>
<H3>Edit Car Attributes</H3>

To the right of each of the car attributes (Road, Type, Length, Color,
Kernel, Load, Owner) is an "Edit" button. Use this to add, delete, or replace
the available attributes for a car.

<P>
<img src="images/EditCarAttribute.png">
</P>

<H3>Add Button</H3>

To add a new car attribute, enter the desired text in the text box and
press the "Add" button.  When you first enter a new car attribute it will
show up at the start of the list.  Later when your restart the program it
will be sorted in the correct order.

<H3>Delete Button</H3>

To delete a car attribute, select the attribute you want to delete in
the menu box and press the "Delete" button.

<H3>Replace Button</H3>

If you need to change a specific car attribute (road, type, color, etc)
in your entire car roster, you can use the "Replace" button found at the
bottom right of the edit car attribute window. For example, if you wish
to change the car road name attribute "UP" to "UPS" for all of your
cars. Press the "Edit" button for any of your cars in the Cars window,
and then press the "Edit" button across from Road in the "Car Edit"
window. Enter the new road "UPS" in the text box, select "UP" in the menu
box, and press "Replace". All cars with "UP" as their road will now have
"UPS" as their road name.

<A	NAME="EditCarLoads"></A>
<H3>Edit Car Loads</H3>

To edit a car's load, press the Load "Edit" button in the Edit Car window.

<P>
<img src="images/EditCarLoads.png">
</P>
<P>
	In addition to the Add, Delete, and Replace buttons and fields
	described above in the <A HREF="#EditCarAttributes">Car Edit
		Attributes</A> section, the edit car loads window allows you to set the
	load's type, priority, pick up and set out messages. A load type of
	"Load" means the program will consider the car as being loaded and
	the maximum car weight is used when calculating the train's total
	weight. A load type of "Empty" tells the program that the car is
	empty as to only use 1/3 of the car's maximum weight when
	calculating the train's total weight. The default load priority is
	low and you can change the priority to high for a given car type and
	load. High priority car loads are normally serviced before low
	priority. Useful if you need to get your reefer loaded with fruit to
	the market ASAP!
</P>

<P>You can also provide optional messages for your operators based on
the type of car and load. The messages can be useful if you have visible
car loads that need to be added or removed by your operators.</P> 

<A NAME="CarsSet"></A>
<H3>Set Car</H3>

After creating a car, you can set the car's location, and optionally the
car's destination and train by using the "Set" button found for each car
in the <A HREF="#Cars">Cars</A> window. Normally the car's destination and assigned
train are generated by the program, but you can use these fields to
force a car to a specific location using a specified train.

<P>You can also remove a car that has been assigned to a train by
simply pressing the "Save" button.</P>
<P>
<img src="images/SetCarLocation.png">
</P>

<P>In the upper right hand corner of the Set Car Location window is a checkbox labeled
"Location Unknown". Selecting the location unknown checkbox does several
things. First the program will ignore the car when building new trains.
Second, on manifests and switch lists, the program will list all of the
misplaced cars. Now your operators can help you find cars that have
been <A HREF="#MisplacedCarsComment">misplaced</A>. And finally, when this checkbox is selected, the other fields in
the set car location window are disabled.</P>
<P>The "Out of Service" checkbox when selected instructs the program to ignore
the car when building new trains.  Many operators have a RIP (Repair In Place) track
and use this feature to hold the car there until repairs have been made.</P>

<P>Use the "Location" set of field to place the car on the layout.
Use the "Auto" checkbox to show valid tracks for a given location.
You can also optionally enter the location and track that you want the
car to return to when the car's load status becomes empty. Note that manually
changing the load status to empty will not cause the Return When Empty (RWE) destination to become
active, only when the car is set out by the program will the RWE destination become active.</P>

<P>You can also change the car's load, or create new ones by using the "Edit" button.</P>

<P>The next three set of fields are normally set by the program when
building trains. We'll explain how they work in
case you're interested in how the program works or if you want to
manually override the program. The first is the "Destination" set of
pull down boxes. The "Destination" is the next location that the car
will be delivered to. The destination must be reachable by only one
train or the car will not be serviced.</P>

<P>The next field is the "Final Destination" set of pull down boxes.
You can select any destination or track, the program will figure out the
best route to ship the car to this destination. The "route" can consist
of several trains, interchanges, and yards. When a car is delivered to a
spur with a schedule, and the schedule has a shipping destination that
requires more than one train, the program uses this set of fields to
ship the car. If the track that the final destination specifies happens
to be full, the program will search for a yard to place the car.
When the track becomes available, the program will move the car from the
yard to the track specified.</P>

<P>The last field is the train assignment. If you want to specify a
car's destination or train, set them before you build your trains.</P>

<P>When manually setting a destination, you don't have to specify a
track. And when manually setting a destination that is staging, you
should never select a destination track, let the program do that for you.</P>

<A NAME="SetCars"></A>
<H3>Set Cars</H3>

If you want to change the location, destinations, status, or train
assignment for a group of cars use the "Set Cars" tool found under
"Tools" in the <A HREF="#Cars">Cars</A> window. The tool works the same
way as the <A HREF="#CarsSet">Set Car Location</A> as described above,
except that multiple cars are modified. Select the cars you want to
change in the table and then select "Set Cars". The first car selected
becomes the default, and if you press the "Change" button, all of the
other selected cars will have the same settings as the
default car. Be sure to press "Save" in the Cars window if you want to
keep your changes.

<H3>Tools</H3>

The cars "Tools" menu allows you to perform some useful functions to
your car roster. In addition to "Import from file" feature described
earlier, you can also export your cars to a comma separated value file.
The "Export to file" function creates a file named
"ExportOperationsCarRoster.csv" in the JMRI-&gt;operations directory. You
can remove all of the cars in your roster using the "Delete all cars"
option. You can also preview and print your car roster. The preview and
print features use the same "Sort by" radio buttons as the cars window.
One of the more useful sorts is by "Location", this allows you to
quickly verify your car locations before or after an operations session.

<A NAME="Locomotives"></A>
<H2>Locomotives</H2>

The locomotives window allows you to edit your locomotive roster. You can enter
a locomotive's number, road, model, type, and length. You can optionally
add the locomotive's build date and owner. If you want a group of locomotives to
be assigned as a unit, you can create a "consist". The locomotive type is
used by the program to determine where locomotives are picked up and or
stored at the various locations on your layout. Some of default locomotive
types are electric, diesel, gas turbine, and steam.

<P>
<img src="images/Locomotives.png">
</P>

<A NAME="ImportLocomotives"></A>
<H3>Import Locomotives</H3>

If you already have a list of locomotives in your JMRI roster or in a
database, you can import the locomotives into the program. To get your
locomotives from your JMRI roster, select "Import from JMRI roster" from the
Tools-&gt;Operations-&gt;Locomotives-&gt;Tools menu. Only locomotives that don't exist
will be added to the programs locomotive roster. This way you can use this
tool any time you add locomotives to your JMRI locomotive roster. The JMRI locomotive
roster doesn't have the length field, so a default length is entered for
you. You should correct the locomotive length if you want the program to
correctly calculate your train lengths.

<H3>Import Locomotives from a File</H3>

The import from file function requires an ACSII text file, with one line
for each locomotive. The locomotive import requires four attributes and
order is locomotive number, road name, model, and length. All four attributes
are required for the import to work correctly. The following
shows two examples of the correct format:

<P>236 UP RS4 40 <BR>
5578 SP SW1200 42</P>
<P>Each line can start with a space and multiple spaces between
fields is okay. Optionally you can include additional attributes in the
following order, owner name, date built, and location. The location can
have two fields, the location name followed by the location's spur or
yard name separated by a hyphen. The following shows two examples of the
correct format:</P>

<BR>
236 UP RS4 40 AT 1930 Home Town USA - Engine Terminal <BR>
5578 SP SW1200 42 DB 1934 York - York Engine Yard

<P>If you prefer to use comma delimiters instead of spaces, use a file with
a .csv extension or place
the word "comma" at the start of your import file and use commas instead
of spaces. The following are two examples of importing locomotives with
comma deliminters.</P>
<P>comma <BR>
236,UP,RS 4,40,AT,1930,Home Town USA,-,Engine Terminal <BR>
5578,SP,SW 1200,42,DB,1934,Town of York,-,York Engine Yard</P>
<P>You need to be very careful with spaces when importing a comma
delimitated file. The program will include leading and trailing spaces
if they exist between the commas.</P>
<P>To import a file, use the "Tools" menu in the upper left hand
corner of the Tools-&gt;Operations-&gt;Locomotives menu. Select
"Tools-&gt;Roster-&gt;Import. Note that the program will only add locomotives that
don't exist in the program's locomotive roster. It the locomotive already
exists, it will be skipped by the program.</P>

<P>After importing your locomotives, you must save them if you want to
keep them as part of your roster. Press the "Save" button located at the
bottom of the Locomotives window, or select any locomotive by pressing the edit
button and then press the "Save" button that can be found at the bottom
right of the "Edit Locomotive" window.</P>

<A NAME="LocomotivesAdd"></A>
<H3>Adding Locomotives to your Roster</H3>

To manually add a locomotive to your roster, press the "Add" button located
at the bottom of the "Locomotives" window. Then select the road for the
locomotive. If the desired road doesn't exist, press the "Edit" button
across from the road select menu box. This will allow you to add a new
road or delete any that you don't need. Now enter the locomotive's number,
model, type, length and horsepower. The locomotive's horsepower, the train's
weight, and track grade is used by the program to calculate how many
locomotives are required when using the "Auto" feature when building trains.

<p>Now set the locomotive's location on the layout. If the locomotive is off
the layout, set the location to none (blank space). If wish this locomotive
to be part of a consist, press "Edit" across from "Consist" and enter a
consist name. Then select the consist name from the menu box. Finally
you can optionally enter the build date, owner and comment for this
locomotive.</P>

<A	NAME="LocomotiveModels"></A>
<H3>Locomotive Models</H3>

The program allows you organize your locomotives by model. Each model can
only have one locomotive type, length, weight and horsepower rating
associated with it. For example, if you assign the model name "RS11" to
a set of locomotives, when you change the length of one of the "RS11"s, the
length will also change for the others.

<H3>Save</H3>

Press "Save" to store the locomotive's settings. The program will create a
file (OperationsEngineRoster.xml) in your JMRI directory in a folder
called "operations". A backup file with the last settings for all of
your locomotives is also created each time the "Save" button is pressed. 

<A	NAME="LocomotivesSet"></A>
<H3>Locomotive Set</H3>

After creating a locomotive, you can set the locomotive's location, and
optionally the locomotive's destination and train. Normally the locomotive's
destination and assigned train are generated by the program, but you can
use these fields to force a locomotive to a specific location using a
specified train.

<H3>Synchronize with NCE Consists</H3>

If you are using NCE as your DCC command station, you can have the
program synchronize your consist numbers with your locomotives. The program
will read all of the consists out of the NCE system and then will search
for matching locomotives in your operations roster. The program will assign
the consist name nce_xxx where xxx is the consist number. To synchronize
your consists, select "Synchronize with NCE Consists" under the "Tools"
menu. 

<A NAME="Routes"></A>
<H2>Routes</H2>

A route is a list of locations that a train will visit. Later you can
decide if the train stops at a location for work. Routes can be point to
point or out and back. To build a route, select
"Tools-&gt;Operations-&gt;Routes".  The Routes window also provides route status,
for example, "Orphan" means the route hasn't been assigned to a train.


<P><img src="images/Routes.png"></P>

<P>Then press the "Add" button located at the bottom of the window.</P>

<P><img src="images/EditRoute.png"></P>

<P>
Enter the route name and an optional comment. This comment is shown in
the routes window, and <A HREF="#ManifestComments">optionally</A> on
your manifests. Each route must have unique name. Then press the "Add
Route" button located at the bottom of the window. Now select the
location the train will depart by selecting the location in the menu box
located at the left bottom side of the window. Press "Add Location". Now
build your route by selecting the next location the train will visit,
select all locations that the train will pass through even if the train
will not work the location. This way your train's engineer will know
when reading his manifest the towns he will be traveling through. Each
time you add a location to the route, the table shows the order in which
the train will visit. You can move a location up or down in the sequence
if needed.
</P>

<A NAME="EditRoute"></A>
<H3>Edit Route</H3>

Each location has the train's departure direction, number of desired car
moves, and whether car pick ups and or car set outs are allowed at that
location. A car move can be a car pick up or car set out at that location.
For example, 5 moves can be 5 pick ups, or 5 set outs, or any combination of
5 pick ups or set outs. Picking up or dropping off a group of cars or a
<A	HREF="#Kernel">kernel</A> represents one move.

<P>If you want to delay the departure of the train from a location
or increase the train's travel time,
enter the number of minutes desired in the "Wait" cell.  Another choice
is to specify the train's departure time from a location.</P>

<P>You can also adjust the <A HREF="#MaximumTrainLength">maximum train length</A> that can depart each
location. The grade is used to determine how many locomotives the train will
require for that segment.</P>

<P>The X and Y are the coordinates on your dispatcher's panel for
the optional train icon. You can set the coordinates here, use the <A
	HREF="#SetTrainIconCoordinates">Set Train Icon Coordinates</A> tool, or
use the "SetX&amp;Y" train icon popup menu to teach the program where you
want the train icon placed when the train is at the specified location.
Leave the X and Y coordinates at zero if you want to manually move the
icon or you're not using the icon feature.</P>

<A NAME="RouteComment"></A>
<p>Each location in the route can also have an optional comment that
will appear on the train manifests.  Press the "Add" button under the
table heading "Comment" to add a comment to a location.</p>

<H3>Save Route</H3>

Press "Save Route" to save your route. The program will create a file
(OperationsRouteRoster.xml) in your JMRI directory in a folder called
"operations". A backup file with the last settings for all of your
routes is also created each time the "Save Route" button is pressed. 
<A	NAME="CopyRoute"></A>
<H3>Copy Route</H3>

In the Route window select "Tools-&gt;Copy Route" to make a copy of your
route. Enter the name of the new route and select the route that you
want to copy. If you want the route reversed check the "Invert" box. 

<A NAME="RouteFeatures"></A>
<H3>Route Features</H3>

One very powerful feature of routes is the ability to specify the same
location more than once. When the same location name is used back to
back, the train's manifest will print as though the train only arrived
and departed once. Note that names "Danville", "Danville-1", and
"Danville-2" are all the same with regards to the manifest and switch
list printouts, but the program deals with them as though they were
different locations.

<P>For example, you can control if there are set outs or pick ups at any
location in the route. Therefore if you wanted to only set out 3 cars,
you could specify only set outs and 3 moves. But what if you wanted to
set out 3 cars and pick up 7 cars. If you specify 10 moves for a
location it can be any combination of 10 pick ups and set outs. Using
"Danville" as our location, we can in our route specify "Danville"
twice, back to back. In the first "Danville" we can specify 3 set outs
only. In the second "Danville" we can specify 7 pick ups only. Now the
program will "try" and meet your request by picking up to 7 cars and
dropping off up to 3 cars.</P>

<P>Another example, the program will not allow you to have staging
tracks and other types of tracks (spurs, yards, interchanges) at the
same location. But using the names above, we could assign yard and
spur tracks to "Danville", and then as long as "Danville-1" was the
last or first location in a route, assign staging tracks to "Daville-1".
Now when the train terminates at Danville, the yard and spur tracks are
serviced, and then the train terminates into staging at "Daville-1".</P>

<P>Another example. Let's say we have a mainline train that will
service Danville. At Danville we have a yard and several spurs. We
want the mainline train to service Danville's yard, but not the spurs.
We don't want to use a switcher to service the spurs at
Danville. However, we do want locals to service them! We need to tell
the program which tracks in Danville are service by which trains.  We might
be able to do this using interchanges, but we're also using schedules on our spurs!  So
that rules out using interchange tracks.</P>
<P>Solution, we create a yard in "Danville", and create spurs in
"Danville-1". The mainline train has "Danville" in it's route. The
locals will service "Danville" and "Danville-1". Now the dilemma, do the
locals service "Danville-1" or "Danville" first? Not an issue, we create
a route for the locals that services "Danville-1", then "Danville", and
then "Danville-1". At the first "Danville-1" we request only pick ups at
the spurs, at "Danville" we specify both pick ups and set outs to the
yard, and at the second "Danville-1" we specify only set outs. </P>

<P>Now the mainline train only services Danville yard.  The locals service Danville yard and the
spurs.</P> 

<A	NAME="SetTrainIconCoordinates"></A>
<H3>Set Train Icon Coordinates</H3>

Use this tool to set the default X and Y coordinates of your train icons
for each location. The tool allows you to specify the icon coordinates
based on the train's direction. You can also update all of your existing
routes and locations with these new coordinates. As an alternative, you
can use a route's "Tools-&gt;Set Train Icon Coordinates for this Route" to
create coordinates unique to a specific route. 

<A NAME="Trains"></A>
<H2>Trains</H2>

Now that we've created our routes we need trains to move cars! Create a
train by selecting "Tools-&gt;Operations-&gt;Trains" from the top level menu.
<P><img src="images/Trains.png"></P>
<P>Press the "Add" button to create a train.</P>
<P><img src="images/EditTrain.png"></P>
<P>Enter the train's name and optional description, and then press
the "Add Train" button. Both will show up on the train's manifest. The
train's name will also show up on the train icon, so short names work
best. Then select the route that this train will travel. There's an Edit
button to the right of the route that allows you to directly edit the
selected route. Once a route is selected a list of locations that the
train will visit should appear. You can deselect any location that you
don't want the train to work.</P>

<H3>Train Departure Time</H3>

Select the time that this train will depart the first location in its
route. You can use the departure time to sort your trains in the order
that you want them built when using the <A HREF="#BuildingTrains">Build
Selected Trains</A> button.  Note that if the train's route has a departure
time for the first location, the route's departure time is used and the
train departure time selection is disabled.

<H3>Train Rolling Stock</H3>

You can determine what type of cars and locomotives the train will service.
Select the rolling stock the train will carry by clicking on the
appropriate checkboxes. A checked box means the train will service this
type of rolling stock. 

<A NAME="TrainRequires"></A>
<H3>Optional Train Requirements</H3>

You can control the number of locomotives that will be assigned to this
train, and optionally, the locomotive's model and road name. If you want two
or more locomotives assigned to a train, the locomotives must be part of a <A
	HREF="#LocomotivesAdd">consist</A>. If you select "Auto", the program will
calculate the number of locomotives required for this train based on the
weight of the train, the track grade, and the horsepower of the locomotives.

<P>You can also require a <A HREF="#CabooseFredHazardous">caboose
or car with FRED (Flashing Rear End Device)</A> as the last car in the
train, and you can optionally specify the road name for the caboose or
car with FRED. If you leave the road name blank, the program will try
and find a caboose with the same road name as the locomotive.</P>

<A NAME="TrainReset"></A>
<H3>Reset Train</H3>

The "Reset Train" button allows you to remove locomotives and cars that have
been assigned to a train. Useful when you want to try various build
options and don't what to physically move locomotives and cars on the
railroad.

<H3>Save Train</H3>

Press "Save Train" to save your train. The program will create a file
(OperationsTrainRoster.xml) in your JMRI directory in a folder called
"operations". A backup file with the last settings for all of your
trains is also created each time the "Save Train" button is pressed. 

<A NAME="TrainOptions"></A>
<H3>Train Options</H3>

You can optionally have a unique railroad name and logo for each train
in your roster. Use the "Edit Train-&gt;Tools-&gt;Options" to enter your
train's railroad name and logo. 

<A NAME="TrainBuildOptions"></A>
<H3> Train Build Options</H3>

In the edit train window menu under "Tools-&gt;Train Build Options"
are additional options for building a train. You can control which
car roads, load, owners, and built dates the train will service.

<P>You can also specify a locomotive change in route or add helper locomotives.</P>

<P><img src="images/TrainBuildOptions.png"></P>

<H3>Options</H3>

You can request that the program use normal mode when building the train.  This is useful when a
train departs staging.  In normal mode, all of the cars in staging are set out first, where in 
aggressive mode, the cars in staging are set out last.
<P>
You can also request that all car pick ups are sent to the last location in your route (terminal).
Useful if you don't want your cars picked up and set out at various locations in your train's route.

<A NAME="TrainRoadNames"></A>
<H3>Train Road Names</H3>

You can control the road names that the train will service. Select under
the "Edit Train-&gt;Tools" menu the "Train Build Options". This will bring
up a new window with several options.

<P>If the train will service any road name, select the "Accept All"
radio button. If you want to accept only some road names, select "Accept
only" radio button. Then use the menu of road names and "Add Road"
button to make a list of road names that the train will service. To
remove a road name from your list, select the road name from the menu
and use the "Delete Road" button.</P>

<P>To build a list of road names that the train will not service,
select the "Exclude" radio button. Use the menu of road names and the
"Add Road" button to build a list of roads that this train will not
service.</P>

<P>Press the "Save Train" button to update the train build options
and close the window when your done.</P>

<H3>Train Car Loads</H3>

You can decide which car loads the train will service. There are two
pull down menus, the first one is the type of car, and the second the
type of load serviced by the car type selected. Use the "Add Load"
button to build a list of loads that the train will either service or
exclude. The "Delete All" button will remove all loads from the list.

<H3>Train Owners</H3>

You can decide which rolling stock the train will service by owner name.
The control is similar to <A HREF="#TrainRoadNames">Train Road Names</A>,
see above.

<H3>Train Built Dates</H3>

You can control which rolling stock the train will service by their
built date. If you want only locomotives and cars built after a certain
year, select the "After" radio button and enter a four digit year in the
text box. If you only want locomotives and cars built before a certain year,
select the "Before" radio button and enter a four digit year in the text
box. And if you want to specify a period, select the "Range" radio
button and enter the after and before years you want the train to
service. 

<H3>Optional Train Requirements</H3>

You can have up to two locomotive changes while the train is in route.
Select "Locomotive change" where you want the change to happen in your
route, and how many new locomotives should be assigned to the train. You can
optionally select the new locomotives model and road. At the locomotive change
location, the previously assigned locomotives will be removed from the
train.

<P>You can also request helper locomotives for those long up hill
battles that your train might experience. The current code only adds a
comment to the manifest requesting helper service starting at the
location you select and removes the helper service at the location you
select.</P>

<A NAME="TrainScripts"></A>
<H3>Scripts</H3>

If you want to run a <a HREF="../../../../html/tools/scripting/index.shtml">script</a> when a train is built, moves or terminates, select
under the "Edit Train-&gt;Tools-&gt;Scripts". This will bring up a new
window with several script options.
<p>Included in the <a HREF="http://jmri.org/jython/operations">jython directory</a> are several examples of
operation oriented scripts.</P>

<A NAME="TrainShowCarTypesServiced"></A>
<H3>Show Car Types Serviced</H3>
<P>This diagnostic tool can help you determine why a train will not
service a particular car type. You can select a car type and see how the
train will service that car type. You can also select a specific car to
see how that car would be serviced.</P>

<P><img src="images/ShowCarTypesServicedTrain.png"></P>
<P>The window shows the train's route along with every location and
track that can be serviced by the train. To the right of each track is
the current status for the car type currently selected in the drop down
menu. If the track status is "OK" then this train can pick up and set out
this type of car to that specific track. If the track status is "Pick up"
or "Set out" then the train can only pick up or set out cars to this
particular track. A status that begins with an "X" means that the
train will not service the track. The following table provides a summary
of the various track statuses.</P>

<table>
	<tr>
		<th>Status</th>
		<th>Description</th>
	</tr>
	<tr>
		<td width="20%">OK</td>
		<td>Selected car type can be picked up and set out</td>
	</tr>
	<tr>
		<td>Pick up</td>
		<td>Selected car type can only be picked up from this track</td>
	</tr>
	<tr>
		<td>Set out</td>
		<td>Selected car type can only be set out to this track</td>
	</tr>
	<tr>
		<td>X (Train Built)</td>
		<td>Selected car built date is not serviced by this train</td>
	</tr>
	<tr>
		<td>X (Train Load)</td>
		<td>Selected car load is not serviced by this train</td>
	</tr>
	<tr>
		<td>X (Train Owner)</td>
		<td>Selected car owner is not serviced by this train</td>
	</tr>
	<tr>
		<td>X (Train Road)</td>
		<td>Selected car road is not serviced by this train</td>
	</tr>
	<tr>
		<td>X (Train Type)</td>
		<td>Selected car type is not serviced by this train</td>
	</tr>
	<tr>
		<td>X (Train Skips)</td>
		<td>The train doesn't service this location</td>
	</tr>
	<tr>
		<td>X (Train Pick up)</td>
		<td>The train can't pick up cars from this track</td>
	</tr>
	<tr>
		<td>X (Train Set out)</td>
		<td>The train can't set out cars to this track</td>
	</tr>
	<tr>
		<td>X (Route)</td>
		<td>The route doesn't allow pick ups or set outs for this location</td>
	</tr>
	<tr>
		<td>X (Route Moves)</td>
		<td>The number of requested car moves for this location is zero</td>
	</tr>
	<tr>
		<td>X (Location Type)</td>
		<td>The location doesn't service the selected car type</td>
	</tr>
	<tr>
		<td>X (Track Road)</td>
		<td>The track doesn't service the selected car road</td>
	</tr>
	<tr>
		<td>X (Track Type)</td>
		<td>The track doesn't service the selected car type</td>
	</tr>
	<tr>
		<td>X (Dir Loc)</td>
		<td>Based on the train's departure direction, the location
		doesn't allow set outs or pick ups</td>
	</tr>
	<tr>
		<td>X (Dir Trk)</td>
		<td>Based on the train's departure direction, the track doesn't
		allow set outs or pick ups</td>
	</tr>
	<tr>
		<td>X (Schedule Timetable)</td>
		<td>The spur's schedule <A HREF="#Schedules">timetable</A> selection prevents the car from being serviced.</td>
	</tr>
	<tr>
		<td>X (Schedule Type)</td>
		<td>The spur's schedule does not allow the car's type to be serviced.</td>
	</tr>
	<tr>
		<td>X (Schedule Load)</td>
		<td>The spur's schedule does not allow the car's load to be serviced.</td>
	</tr>
	<tr>
		<td>X (Schedule Road)</td>
		<td>The spur's schedule does not allow the car's road to be serviced.</td>
	</tr>
	<tr>
		<td>X (Schedule)</td>
		<td>The spur's schedule does not allow the combination of the car's type, load, and road.</td>
	</tr>
</table>

<A NAME="ModifyTrainsByCarType"></A>
<H3>Modify Trains by Car Type</H3>

This tool can be found under Trains-&gt;Tools. Use this tool to quickly
modify the type of cars your trains will service. Very useful when
adding a new car type to your roster. 

<P><img src="images/ModifyTrainsByCarType.png"></P>

<P>First select the car type you wish to modify. The window will
then show which trains can service that car type. Select or deselect the
trains you want to service, and press the "Save" button to modify your
trains. You can also copy how an existing car is serviced by your trains
and apply those rules to another car. To make a car type behave like
another, first select the car your would like to copy, then select the
"copy" checkbox, the car type will now appear to the right of the
checkbox, then select the type of car you want to modify, and press
"Save" to have both car types serviced by the same trains.</P>

<A NAME="SwitcherService"></A>
<H3>Switcher Service</H3>

Many operators assign a locomotive to a location to do the local switching.
Using the location's switch list allows the person assigned to the
location to service all trains that stop at that location. However,
there can be locations that don't get enough work servicing through or
local trains and it would be nice to create some additional work for the
operator assigned to that location. To create a "switcher" job, create a
route with one location, the location that the switcher will service,
and assign that route to a train. The "train" now becomes a switcher
that will only service that location. Adjust the "Move" count in the
route to control how many cars the switcher will service.

<P>Some operators like to produce a train manifest that only shows
set outs or pick ups from a yard or interchange, and then have a switch list
that shows moves between the yard and spurs. To eliminate tracks from
showing up on a train's manifest, deselect all of the direction boxes
for that track. Only a "switcher" will service a track that doesn't have
any direction boxes selected.</P>

<H3>Switcher Restrictions</H3>

The program when generating a manifest for a switcher (a train with a single
location in its route) will by default never move a car from a spur
to a spur or yard to a yard, only yard to spur or spur to yard.
This rule also applies to interchanges. This restriction helps prevent
unrealistic car movements between spurs (industries). However, if you want a
spur to spur move, use a <A HREF="#Schedules">Schedule</A> to
force the car move. You can also disable this restriction see 
<A	HREF="#AllowLocalCarMovements">Options.</A>

<A NAME="BuildingTrains"></A>
<H2>Building Trains</H2>

To build one train, press the "Build" button in the row for the desired
train in the <A HREF="#Trains">Trains</A> window. The button will become
"Print" or "Preview" after the train is built. If you want to review how
the train was built, select the "Build Reports" checkbox before pressing the
"Print" or "Preview" button for the desired train. If the "Preview
Manifest" checkbox is selected, the program will generate the build
report and manifest and present them in preview windows. If you want to
build several trains without having to press individual buttons for each
train, select the trains that you want built and press the "Build"
button found at the bottom of the trains window. The program will then
build manifests for all of the selected trains.

<P>If a train fails to build, the "Move" button will change its text
to "Report". Pressing "Report" will print or preview the build report
for this train. Whenever a train fails to build, a build failure message
will appear. If you want to disable this feature deselect the checkbox
"Build Messages".</P>
<P>You can also control which trains are shown in the Trains window.
When the "Show All" checkbox is unselected, only trains that have the
"Build" checkbox selected are shown.</P>

<A NAME="Timetable"></A>
<H3>Timetable</H3>

The Timetable tool allows you to define which trains will run on any
given day, and can be found under the Trains-&gt;Tools. For each day of
the week, select which trains you want to build. Then select which day
you want by selecting the appropriate radio button. Then press the
"Apply" button to update the Trains build checkboxes. Use the "Save"
button to store any changes you made to the timetable. 

<A NAME="TroubleShootingBuildingTrains"></A>
<H2>Problems Building Trains</H2>

If you have a problem building a train you can select the "Build
Reports" checkbox at the bottom of the train window. When a build fails
for any reason and the "Build Reports" checkbox is selected, the program
will send a report to your printer if the "Preview Manifests" isn't
selected; or to a preview window if the "Preview Manifest" is selected.
The build report can print out different levels of detail, from minimal
to very detailed. See the Settings section <A HREF="#BuildReportDetails">Build
Report Details</A> for more information on how to change the build report
detail level.

<P><img src="images/BuildReport.png"></P>
<H3>Reading the Build Report</H3>

The program when building a train creates a build report and saves it to
disk. The text files can be found in the
JMRI-&gt;operations-&gt;buildstatus directory. The build report shows
the steps the operations program goes through while building a train.
The first page provides the route the train will travel and the number
of car moves requested for each location. The report then shows the car
type and locomotive types that the train will service. By reading the
various comments in the report you can get an idea of steps the
operations program goes through to build a train. When there's an issue
that the operation's build can't resolve, the build will fail. To
understand why a build failed, go to the last page of the build report
and by working backwards from the last line, you should be able to
understand why a train failed to build.

<H3>More Build Report Details</H3>

For those who want to understand how the program builds trains here's
the details. If the train requires a locomotive or several locomotives,
the program will look for locomotives at the start of the route and then
determines if the termination location will accept them. Note that if
two or more locomotives are required for the train that the locomotives
must be in a <A HREF="#LocomotivesAdd">consist</A>. The program assigns
to the rolling stock (locomotives and cars) the number of moves that
they experience during each session. The move count is bumped up each
time the rolling stock is set out to a new location's track, or if
the rolling stock was assigned to a train and the train was reset. The
program sorts the rolling stock by the move count, and then tries to
assign locomotives and cars with the least number of moves to the train.
When building a train only rolling stock at locations that are part of
the train's route are used. With regards to cars, in addition to the
number of moves a car has experienced, the car's load priority is also
considered. The program will try and find destinations for cars with
high priority loads before low priority loads.

<P>The next step is to optionally assign a caboose or car with FRED to the
train. If the program finds the required caboose or car with FRED at the
start of the route, the program tries to find a track at the termination
location that will accept it. If successful, all other cabooses and cars
with FRED are removed from the available car list.</P>

<P>Next the program will assign cars to the train starting from the
departure location. Each car goes through the process of finding a track
along the route that will accept the car. Another count assigned to a
track is used to determine if the track has been serviced recently.
Tracks with the least amount of service get priority. A car can have
several track choices and the one with the highest priority will be
assigned as the car's destination. The process continues until the
number of car moves requested by a location is met, or the available
cars being processed by the program is used up. Once the car moves
requested for a location is met, the next location in the route is
processed. This continues until all locations in a train's route have
been processed.</P>

<P>In <A HREF="#SettingsOptions">aggressive mode</A> , the program
when figuring out destinations for cars, will do two passes when
determining where to place cars. The first pass does 50% of the
available moves for each location, and the second pass does the
remainder. By doing two passes, the program can "free" up some spurs
that already have cars there, thus increasing the number of cars that
the train can service. Once a car has been given a destination in
aggressive mode, the car's current track space is available for other
trains to use.</P>

<P>If a car has a final destination that was set by a schedule, the
program will try and move the car to that destination, or if not
possible, it will try and move the car closer to that final destination.</P>

<P>If a car has a custom load without a destination, the program will 
search for a spur with a schedule demanding that car type and load.  
the program will then "route" the car to that destination.  The program
will use up to five trains to get the car to a destination.
</P>

<P>Sometimes reading the build report can get tedious. If you want
to use a text editor to search the report, the build reports can be
found in the directory JMRI-&gt;operations-&gt;buildstatus.</P>

<A NAME="PrintingManifests"></A>
<H3>Printing Manifests</H3>

After building a train, the "Build" button will become "Print" or
"Preview" depending on the state of the checkbox called "Preview
Manifests" located in the lower right corner of the Trains window.
Pressing the "Print" button will print the manifest for that train.
Pressing the "Preview" button will produce a window in which you can
review the manifest. If you want to print manifests for several trains,
select the trains you want in the build column and then press the
"Print" or "Preview" button found at the bottom of the trains window.
The program will then print or preview manifests for all of the selected
trains.

<P><img src="images/Manifest.png"></P>

<A NAME="SwitchList"></A>
<H3>Switch Lists</H3>

A switch list shows the work required to service all of the trains
visiting that location. Normally a switch list is given to the person in
charge of a yard or a location with many spurs or industries.

<P>Press the "Print Switch List" button if you want a switch list
for a given location. A menu will appear that allows you to select which
locations to preview or print. Once you've determined which locations
you want to print or preview, press the "Save" button to keep your
selections.</P>

<P><img src="images/SwitchList.png"></P>

<A NAME="TrainMove"></A>
<H3>Moving Trains</H3>

After providing your operators with a printed manifest or location
switch list, you must keep the program database synchronized with the
actual movement of trains on your layout. This is done by the train
"Move" buttons located on the right side of the <A HREF="#Trains">Trains</A>
window. Pressing the "Move" button will cause the train to depart its
current location move to the next location in the route. The locomotives and
cars assigned to the train will travel to the next location on the
railroad. At each location, cars can be picked up or set out. You
can also move a train by selecting the train's icon and selecting "Move"
from the icon's popup menu. Each press of the "Move" button moves the
train closer to its terminal location. When the train arrives at the
last location in the route, the last press of the "Move" button will
terminate the train. Once a train is terminated, you can build it again.

<P>Each time a locomotive or car is moved a count associated with them
is incremented. The program uses this to determine which cars haven't
moved recently and tries to select cars with the least number of moves
when building new trains. Each time a location has a car
set out, the program increments a count associated with that location.
The program tries to move cars to locations that have experienced the
least number of car operations.</P>

<H3>Terminate Trains</H3>

When you terminate a train, you are asking the program to move the train
from its current location to its final destination. The cars and locomotives
associated with the train will be picked up and delivered to the
locations shown in the train manifest. After terminating a train the
locomotives and cars associated with that train become available for other
trains. Therefore you should terminate a train only after it actually
arrives at the final destination in the train's route. To terminate
several trains, select the trains you wish to terminate in the build
column and press the "Terminate" button at the bottom of the Trains
window.

<H3>Save Builds</H3>

Pressing the "Save Builds" button causes the program to update the
train, car, locomotive, and location xml files. Any time you "Move" a train
the operations program will make changes to the train, car, locomotive, and
location databases. These databases must be saved before you shut down
JMRI, otherwise you will lose all of the changes that the operations
program made to move a train to the next location. Pressing the "Save
Builds" button before quitting JMRI allows the operations program to
resume exactly at the point where you pressed the "Save Builds" button.

<H2>Building Multiple Trains for a Session</H2>

Most operating sessions require more than one train to keep your
operators busy. The correct way to do this is to build and print all of
the trains needed before terminating them. So if you need a dozen trains
for a session, you must build twelve trains before you terminate any one
train. Terminating a train tells the program that the locomotives and cars
in that particular train have been delivered to their final locations
and can be used again when building new trains. So always build all,
print all, THEN terminate each train after completing its run! It is
okay to build all trains, print all trains, and then use the "Save
Builds" button and shut down the program. Later you can restart the
program and terminate the trains that completed their runs.

<p>The correct time to terminate a train is when the train actually
arrives at its destination. Terminating a train before it completes it
run means that the operation database believes that the locomotives and cars
have been delivered. It is better to build and print twelve trains and
then later find out that only nine trains completed their runs. You
would then terminate nine trains, and leave the other three for next
time. Or if you wish you could reset any trains that didn't depart from
their terminal. Reseting trains really isn't necessary, the trains that
didn't run during this session could run the during the next session.</P>
<p>An alternate method is to build, print, and use the "Move" button
for each train to track the actual movement of the trains during your
session. As long as the trains on your layout match the locations in the
program you can build a new train.</P>

<H2>Operation Windows</H2>

All of the operation windows can be resized and placed to your liking.
When you close the window, the size and window location on your screen
is saved.

<P>The program also allows you to resize the Cars, Locomotives, Trains
and Timetable table column widths. Adjust the column widths to your
liking and then press the window's "Save" or "Save Builds" to save your
preferences.</P>

<P>The end of operations help.</P></DIV>
<!-- closes #mainContent--></DIV>
<!-- closes #mBody-->
</BODY>
</HTML>


